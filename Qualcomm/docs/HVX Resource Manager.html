<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta content="text/html;charset=utf-8" http-equiv="Content-Type">
<style type="text/css">
table {
   border-collapse: collapse;
   border-width: 1px;
   border-spacing: 1px;
   border-color: transparent;
   margin: 16px 0;
   width: 100%;
}
th {
   background-color: #bbb; color: white;
}
td, th {
   border-style: solid;
   border-color: black;
   border-width: 1px;
   padding: 0 6px;
}
td p:first-child, th p:first-child {
   margin-top: 3px;
}
td p:last-child, th p:last-child {
   margin-bottom: 3px;
}

.smarkdoc {
  margin-left: 42px; margin-right: 42px;
  font-size: 13px;
  font-family: 'Lucida Grande', Geneva, Helvetica, Arial, sans-serif;
}

h1, h2, h3 { color: #3c4c6c; }
h1 {
  text-align: center;
  font-size: 200%;
/*    margin-left: -30px; */
  clear: both;
}
h2 {
  font-size: 160%;
  margin: 32px -40px 24px -42px;
  padding: 3px 24px 8px;
  border-bottom: 2px solid #5088c5;
  clear: both;
}
h3 {
  font-size: 130%;
  margin: 20px -4px 10px;
  padding: 4px;
  clear: both;
}
h4 {
  font-size: 110%;
  margin: 2em 0 1em;
}

pre {
  font-size: 90%;
  background-color: #f0f0f4; padding: 6px; border: 1px solid #d0d0ee;
  font-family: "Courier New", "Lucida Console", "Monaco", monospace;
}

.pre {
  font-size: 90%;
  padding: 6px;
  background-color: #f0f0f4;
  font-family: "Courier New", "Lucida Console", "Monaco", monospace;
}

code {
  font-size: 90%;
  font-family: "Courier New", "Lucida Console", "Monaco", monospace;
}

h3 code {
  font-size: 100%;
}

p {
  margin: 0.8em 0;
}
ul, ol {
  margin: 1em 0 1em 3em; padding: 0;
}
div.indent {
  margin: 0 3em;
}

a[href] {
  text-decoration: none;
  color: #2020b0;
}
a[href]:hover {
  border-bottom: 1px dotted #2030d0;
}

/* Smark Users Guide */

.codebox {
  padding: 0 1px;  margin-right:1px;
  border:1px solid #d0d0ee;
  background-color: #f0f0f4;
  font-weight: bold;
  font-family: "Courier New", "Lucida Console", "Monaco", monospace;
}

/* ================ Smark-specific classes ================ */

.indent {
  margin: 0 3em;
}

/*
|| Floats affect text flow but not block boundaries, so graphics in a DIV
|| would overlap floats if not for "clear: both"
*/
.diagram {
  margin: 18px 0;
  clear: both;
}

/* ASCII Art */

.art {
  margin-right: auto; margin-left: auto; /* center */
  font-family: Arial, Verdana, "Lucida Console", Monaco, monospace;
  font-weight: bold;
}
.art * {
   border-color: #543;
}
.art .dline, .art .drect {
   border-style: dotted;
}
.art .rect {
   -webkit-box-shadow: 0.2em 0.2em 0.3em rgba(0,0,0,0.3);
   -moz-box-shadow: 0.2em 0.2em 0.3em rgba(0,0,0,0.3);
   box-shadow: 0.2em 0.2em 0.2em #875;
   background-color: #f9faf4; /* #fafff4; #f8f8ec;  */
}
.art .nofx {
   background-color: #f9faf4;
}
.art .round {
   border-radius: 0.6em;
   -webkit-border-radius: 0.6em;
   -moz-border-radius: 0.6em;
}

/* .art .line {  -webkit-box-shadow: 0.1em 0.1em 0.2em rgba(0,0,0,0.3); } */

/* Sequence Charts */

.msc {
   font: 11px Verdana, Monaco, "Lucida Console";
   margin-left: auto; margin-right: auto;
   background-color: white;
   /* border: 1px solid #555; */  /* Useful for non-white pages */
}

/* Table of Contents */

.tocLevel {
  margin-left: 2em;
  font-weight: normal;
}
.tocLevel .tocLevel {
  font-size: 90%; /* ...of inherited font size */
  line-height: 150%; /* ...of font size */
}
.toc > .tocLevel {
  font-weight: bold;
  margin: 0.5em 0
}
.toc {
  column-count: 2; column-gap: 2em;
  -moz-column-count: 2; -moz-column-gap: 2em;
  -webkit-column-count: 2; -webkit-column-gap: 2em;
}

/* ordinary text content is in P elements */

td p:first-child, th p:first-child {
   margin-top: 3px;
}
td p:last-child, th p:last-child {
   margin-bottom: 3px;
}
li p:only-child {
  margin-top: 0;
  margin-bottom: 0;
}

/* ================ Print ================ */

@media print {

  @page {
    margin: 0.75in 0.75in;
    size: Letter;
    @bottom {
      content: counter(page);
      vertical-align: top;
      padding-top: 1em;
    }
  }
  h1 { text-align: center;
       margin: 3in 0 20px; }
  h2 { page-break-before: always; }
  h2 { string-set: section content() }
  .toc { margin: 3em -2em }
  .toc a::after {
     font-size: 10px;
     content: leader(' . ') "  " target-counter(attr(href), page);
  }
  table { page-break-inside: avoid; }
}

/* ================  Layout  ================ */
/*
 *  +------------------------+
 *  |         #header        |
 *  +----------+-------------+
 *  | #sidebar |  #content   |
 *  |          |             |
 *  +----------+-------------+
 *
 * CSS padding, border width, and border style (!) affect the actual height
 * (and in turn layout).
 */

#header {
  position: fixed;
  top: 0px;
  height: 32px;
  left: 0px;
  width: 100%;
  padding: 10px 10px 0 0;
}
#sidebar {
  position: fixed;
  top: 42px;
  bottom: 0px;
  left: 0px;
  min-width: 180px;
  overflow: auto;
  border: 1px solid transparent;
  border-width: 0 1px 0 1px;
  padding: 0px 5px 0px 5px;
}
#content {
  position: fixed;
  top: 60px;
  left: 200px;
  bottom: 0px;
  right: 0px;
  overflow: auto;
  -webkit-overflow-scrolling: touch;
  padding: 10px 20px;
  padding-top: 0;
}

/* ================  Styles  ================ */


body {
  font-family: "Lucida Grande", Helvetica, Arial, sans-serif;
  font-size: 16px;
}

#header {
  color: #fff;
  background: #555;
  text-align: center;
  font-size: 25px;
}

#sidebar {
  color: #000;
  background: #eee;
  border-right: 1px solid #bbb;
  text-align: left;
  font-size: 12px;
  line-height: 50%;
}

#sidebar h1 {
  margin: 0 0 0 0;
  border-left: 5px solid transparent;
  text-align: left;
  font-size: 12px;
  /*text-shadow: #fff 1px 0px;*/
  line-height: 1%;
}

#sidebar h2 {
  margin: 2px 0 8px 0;
  border-left: 5px solid transparent;
  text-align: center;
  font-size: 12px;
  /*text-shadow: #fff 1px 0px;*/
  line-height: 1%;
}



#content {
  margin: 0;
  font-size: 13px;
  line-height: 160%;
}

#content h1, #content h2 {
  border-bottom: 2px solid;
  font-size: 1.8em;
  font-weight: normal;
  margin: 2.0em 0px 1.3em 0px;
  padding-bottom: 0.6em;
  text-align: left;
}

#content h3 {
  color: #242220;
  font-size: 1.4em;
  font-weight: normal;
  margin: 2em 0px 0.8em 0px;
  text-shadow: #FFFFFF 0px 1px 1px;
}
#content h4 {
  font-size: 1.2em;
  font-weight: normal;
  margin: 2em 0px 0.5em 0px;
  text-shadow: #FFFFFF 0px 1px 1px;
}

a[href] {
  color: #05c;
  text-decoration: none;
}

#sidebar a {
  /*text-shadow:  1px 1px 2px #fff, -1px -1px #ddd;*/
  line-height: 40%;
}

pre, code {
  font-family: "Courier New", "Lucida Console", "Monaco", monospace;
  font-family: "Monaco", monospace;  font-size: 90%;
  background-color: #f8f8fa;
  border: 1px solid #e4e4ee;
  -webkit-border-radius: 2px;
  -moz-border-radius: 2px;
  border-radius: 2px;
  padding: 1px 0 0 1px;
}

pre {
  padding: 2px 4px;
}

table {
   border-collapse: collapse;
   border-width: 1px;
   border-spacing: 1px;
   border-color: transparent;
   margin: 16px 0;
   width: 100%;
}
th {
   background-color: #bbb; color: white;
}
td, th {
   border-style: solid;
   border-color: black;
   border-width: 1px;
   padding: 0 6px;
}

/* Highlight currently-selected sidebar link */

#sidebar a.thisfile {
  color: #557;
}

/* indentation */

#content {
   padding-left: 60px;
}
#content h1, 
#content h2, 
#content h3, h4 {
    margin-left: -30px;
}

h3 > code {
    font-size: 80%;
}

/* ================ Smark-specific classes ================ */

.indent {
  margin: 0 3em;
}

/*
|| Floats affect text flow but not block boundaries, so graphics in a DIV 
|| would overlap floats if not for "clear: both"
*/
.diagram {
  margin: 18px 0;
  clear: both;
}

/* ASCII Art */

.art {
  margin-right: auto; margin-left: auto; /* center */
  font-family: Arial, Verdana, "Lucida Console", Monaco, monospace;
  font-weight: bold;
}
.art * {
   border-color: #543;
}
.art .dline, .art .drect {
   border-style: dotted;
}
.art .rect {
   -webkit-box-shadow: 0.2em 0.2em 0.3em rgba(0,0,0,0.3);
   -moz-box-shadow: 0.2em 0.2em 0.3em rgba(0,0,0,0.3);
   box-shadow: 0.2em 0.2em 0.2em #875;
   background-color: #f9faf4; /* #fafff4; #f8f8ec;  */
}
.art .nofx {
   background-color: #f9faf4;
}
.art .round {
   border-radius: 0.6em;
   -webkit-border-radius: 0.6em;
   -moz-border-radius: 0.6em;
}

/* Sequence Charts */

.msc {
   font: 11px Verdana, Monaco, "Lucida Console"; 
   margin-left: auto; margin-right: auto;
   background-color: white;
   border: 1px solid #555;
}

/* Table of Contents */

.tocLevel {
  margin-left: 2em;
  font-weight: normal;
}
.tocLevel .tocLevel {
  font-size: 90%; /* ...of inherited font size */
  line-height: 150%; /* ...of font size */
}
/*
.toc > .tocLevel {
  font-weight: bold;
  margin: 0.5em 0
}
*/

.toc {
  column-count: 1; column-gap: 2em;
  -moz-column-count: 1; -moz-column-gap: 2em;
  -webkit-column-count: 1; -webkit-column-gap: 2em; 
   alternate: column-width: 235px; column-rule-width: 5px;
}


.columns {
  column-count: 2; column-gap: 2em;
  -moz-column-count: 2; -moz-column-gap: 2em;
  -webkit-column-count: 2; -webkit-column-gap: 2em; p
}

/* ordinary text content is in P elements */

td p:first-child, th p:first-child {
   margin-top: 3px;
}
td p:last-child, th p:last-child {
   margin-bottom: 3px;
}
li p:only-child {
  margin-top: 0;
  margin-bottom: 0;
}


/* ================ Print ================ */

@media print {

  #header, #content { position: static; }
  #sidebar { display: none; }

  @page {
    margin: 0.75in 0.75in;
    size: Letter;
    @bottom {
      content: counter(page);
      vertical-align: top;
      padding-top: 1em;
    }
  }
  h1 { text-align: center;
       margin: 1in 0 1in; }
  h2 { page-break-before: always; }
  h2 { string-set: section content() }
  .toc { margin: 3em 0 }
  .toc a::after {
     font-size: 10px;
     content: leader(' . ') "  " target-counter(attr(href), page);
  }
  table { page-break-inside: avoid; }
}


</style><style type="text/css">
.search { right: 20pt; position: fixed; top: 5pt }

</style><style type="text/css">
.html2d { position: relative; }
.html2d div { position: absolute; border-width: 0; border-style: solid; }
.html2d div div { position: absolute; border-width: 0; border-style: solid; }

</style><title>HVX Resource Manager (HVX RM) for SDM660</title>
</head><body>
<div class="smarkdoc"><div id="header">Hexagon SDK 3.4.3</div><div id="sidebar"><top><img src="images/sidebar_top.jpg"></top><script src="scripts/post.js" type="text/javascript"></script><form class="search" id="searchForm"><input id="searchquery" name="q" onkeydown="postFunctionKeydown(event, false)"><input id="searchButton" onclick="postFunction(false)" type="button" value="Search"></form><p>
<a href="index.html">Quick start</a>
</p><hr>
<p>
<a href="feature_matrix.html">Feature Matrix</a>
</p><hr>
<p>
<a href="hexagon_architecture.html">Hexagon Architecture</a>
</p><hr>
<p>
<a href="images/Hexagon_Document_Bundle.pdf#page=2881">Hexagon Compiler/Linker</a>
</p><hr>
<p>
<a href="hexagon_libraries.html">Hexagon Standard Libraries</a>
</p><hr>
<p>
<a href="images/80-VB419-178_QuRT_User_Guide.pdf">Hexagon RTOS</a>
</p><hr>
<p>
<a href="images/80-VB419-108_Hexagon_DSP_User_Guide.pdf">Hexagon DSP Programming</a>
</p><hr>
<h3>
<a name="Platforms"></a>Platforms
</h3><p>
<a href="Platforms_HLOS.html">HLOS</a>
</p><p>
<a href="Platforms_Simulator.html">Simulator</a>
</p><p>
<a href="Platforms_Target.html">Target</a>
</p><hr>
<h3>
<a name="Environments"></a>Environments
</h3><p>
<a href="Environments_Build%20System.html">Build System</a>
</p><p>
<a href="Environments_Build%20System%20Porting.html">Build System Porting</a>
</p><p>
<a href="Environments_Hexagon%20IDE.html">Hexagon IDE</a>
</p><hr>
<h3>
<a name="ArchitectureOverview"></a>ArchitectureOverview
</h3><p>
<a href="HVX/ArchitectureOverview.html">HVX</a>
</p><hr>
<h3>
<a name="Applications"></a>Applications
</h3><p>
<a href="Audio/Applications.html">Audio</a>
</p><p>
<a href="Camera%20streaming/Applications.html">Camera streaming</a>
</p><p>
<a href="Applications_Compute%20offload.html">Compute offload</a>
</p><p>
<a href="FastCV/Applications_Computer%20Vision.html">Computer Vision</a>
</p><p>
<a href="Neural%20Networks/Applications.html">Neural Networks</a>
</p><p>
<a href="Voice/Applications.html">Voice</a>
</p><hr>
<h3>
<a name="APIs"></a>APIs
</h3><p>
<a href="APIs_Async%20Message%20Queue.html">Async Message Queue</a>
</p><p>
<a href="APIs_DSP%20Clk%20&amp;%20Rsrc%20Mgmt.html">DSP Clk &amp; Rsrc Mgmt</a>
</p><p>
<a href="APIs_Dynamic%20Loading.html">Dynamic Loading</a>
</p><p>
<a href="APIs_FastRPC.html">FastRPC</a>
</p><hr>
<h3>
<a name="Examples"></a>Examples
</h3><p>
<a href="Audio/Examples.html">Audio</a>
</p><p>
<a href="Camera%20streaming/Examples.html">Camera streaming</a>
</p><p>
<a href="Examples_Common.html">Common</a>
</p><p>
<a href="Examples_ComputeHVX.html">ComputeHVX</a>
</p><p>
<a href="Examples_GeneralOverview.html">GeneralOverview</a>
</p><p>
<a href="Neural%20Networks/Examples.html">Neural Networks</a>
</p><hr>
<h3>
<a name="Testing"></a>Testing
</h3><p>
<a href="CAPIv2/Testing_CAPIv2%20Unit%20Tests.html">CAPIv2 Unit Tests</a>
</p><p>
<a href="Testing_Eclipse%20Unit%20Tests.html">Eclipse Unit Tests</a>
</p><hr>
<h3>
<a name="Debugging"></a>Debugging
</h3><p>
<a href="Debugging_Connect%20to%20Device.html">Connect to Device</a>
</p><p>
<a href="Debugging_Exceptions.html">Exceptions</a>
</p><p>
<a href="Debugging_Message%20Logging.html">Message Logging</a>
</p><p>
<a href="Debugging_Simulator.html">Simulator</a>
</p><p>
<a href="Debugging_Target.html">Target</a>
</p><hr>
<h3>
<a name="Tools"></a>Tools
</h3><p>
<a href="Tools_Hexagon%20Tools%208.3.html">Hexagon Tools 8.3</a>
</p><p>
<a href="Tools_IDL%20Compiler.html">IDL Compiler</a>
</p><p>
<a href="Tools_On%20Target%20Profiling.html">On Target Profiling</a>
</p><p>
<a href="Tools_Scripts.html">Scripts</a>
</p><p>
<a href="Tools_Signing.html">Signing</a>
</p><p>
<a href="Tools_UserGuides.html">UserGuides</a>
</p><p>
<a href="Tools_Utilities.html">Utilities</a>
</p><hr>
<h3>
<a name="FAQ"></a>FAQ
</h3><p>
<a href="FAQ_Common.html">Common</a>
</p><p>
<a href="FAQ_Dynamic%20Loading.html">Dynamic Loading</a>
</p><p>
<a href="FAQ_FastRPC.html">FastRPC</a>
</p><p>
<a href="FAQ_Hexagon%20IDE.html">Hexagon IDE</a>
</p><hr>
<h3>
<a name="Dependencies"></a>Dependencies
</h3><p>
<a href="Dependencies_Common.html">Common</a>
</p><hr>
<h3>
<a name="Release%20Notes"></a>Release Notes
</h3><p>
<a href="Release%20Notes_Common.html">Common</a>
</p><hr>
<h3>
<a name="Support"></a>Support
</h3><p>
<a href="Support_Contact.html">Contact</a>
</p><center><img src="images/sidebar_bot.jpg"></center></div><div id="content"><a name="_top_" style="display:block;"></a><h1>
<a name="HVX%20Resource%20Manager%20(HVX%20RM)%20for%20SDM660"></a>HVX Resource Manager (HVX RM) for SDM660
</h1><div class="toc"><div class="tocLevel"><a href="#Overview">Overview</a></div><div class="tocLevel"><a href="#HVX%20RM%20Configuration">HVX RM Configuration</a><div class="tocLevel"><a href="#HVX%20RM%20Enable%20field">HVX RM Enable field</a></div><div class="tocLevel"><a href="#Default%20timeout%20fields">Default timeout fields</a></div></div><div class="tocLevel"><a href="#Existing%20QuRT%20APIs%20and%20their%20behavior">Existing QuRT APIs and their behavior</a></div><div class="tocLevel"><a href="#Newly%20added%20APIs">Newly added APIs</a><div class="tocLevel"><a href="#resmgr_hvx_lock_timeout">resmgr_hvx_lock_timeout</a><div class="tocLevel"><a href="#Example">Example</a></div></div><div class="tocLevel"><a href="#resmgr_hvx_config_update">resmgr_hvx_config_update</a><div class="tocLevel"><a href="#_Example">Example</a></div></div></div></div><h2>
<a name="Overview"></a>Overview
</h2><p>
SDM660 CDSP has 2x128B / 4x64B HVX units. Once a thread locks a HVX resource, it can't be shared with others untill it's unlocked. Depending on the type of QuRT HVX lock call, when there is no available HVX unit to lock, either the API returns failure (qurt_hvx_try_lock) or waits indefinitely for an available HVX unit (qurt_hvx_lock). HVX Resource Manager (HVX RM) implements a timeout for each of these QuRT HVX lock requests and is transparent to the user. A thread requesting for a HVX unit is pushed to a wait queue when there is no available HVX unit until the requested resource is available or on the timeout event, which ever happens first.
</p><p>
HVX RM is by default enabled in SDM660 CDSP builds.
</p><div class=diagram>
<div class="html2d art" style="width:640px;height:734px;font-size:7.73px;white-space:nowrap;line-height:9.92px">
<div class="rect round" style="border-width:3px;left:1px;top:123px;right:562px;bottom:579px"></div>
<div class="rect round" style="border-width:3px;left:229px;top:43px;right:244px;bottom:658px"></div>
<div class="rect round" style="border-width:3px;left:229px;top:678px;right:229px;bottom:23px"></div>
<div class="rect round" style="border-width:3px;left:229px;top:351px;right:234px;bottom:301px"></div>
<div class="rect round" style="border-width:3px;left:1px;top:43px;right:562px;bottom:658px"></div>
<div class="rect round" style="border-width:3px;left:229px;top:222px;right:229px;bottom:430px"></div>
<div class="rect round" style="border-width:3px;left:229px;top:499px;right:229px;bottom:152px"></div>
<div class="rect round" style="border-width:3px;left:229px;top:123px;right:244px;bottom:579px"></div>
<div style="border-bottom: 3px solid transparent;border-left-width: 6.5px;border-top: 3px solid transparent;left:211.5px;top:41.5px;line-height:0"></div>
<div class=line style="border-top-width:2px;left:83px;top:44px;right:424px;bottom:688px;line-height:0"></div>
<div style="border-bottom: 3px solid transparent;border-left-width: 7px;border-top: 3px solid transparent;left:449.5px;top:369px;line-height:0"></div>
<div class=line style="border-top-width:2px;left:435px;top:371px;right:186px;bottom:361px;line-height:0"></div>
<div class=line style="border-left-width:2px;left:309px;top:78px;right:329px;bottom:614px"></div>
<div style="border-bottom: 3px solid transparent;border-right-width: 7px;border-top: 3px solid transparent;left:406.5px;top:61.5px;line-height:0"></div>
<div style="border-bottom: 3px solid transparent;border-left-width: 6.5px;border-top: 3px solid transparent;left:613.5px;top:61.5px;line-height:0"></div>
<div class=line style="border-top-width:2px;left:409px;top:63px;right:22px;bottom:669px;line-height:0"></div>
<div class=line style="border-width:2px;border-bottom-width:0;-webkit-border-top-right-radius:4px;-moz-border-radius-topright:4px;border-top-right-radius:4px;-webkit-border-top-left-radius:4px;-moz-border-radius-topleft:4px;border-top-left-radius:4px;left:6px;top:222px;right:562px;bottom:495px"></div>
<div style="border-bottom: 3px solid transparent;border-left-width: 6.5px;border-top: 3px solid transparent;left:211.5px;top:349px;line-height:0"></div>
<div class=line style="border-top-width:2px;left:83px;top:351px;right:424px;bottom:381px;line-height:0"></div>
<div class=line style="border-left-width:2px;left:309px;top:435px;right:329px;bottom:237px"></div>
<div style="border-bottom: 3px solid transparent;border-right-width: 7px;border-top: 3px solid transparent;left:411.5px;top:359px;line-height:0"></div>
<div class=line style="border-top-width:2px;left:414px;top:361px;right:203px;bottom:371px;line-height:0"></div>
<div style="border-bottom: 3px solid transparent;border-right-width: 6.5px;border-top: 3px solid transparent;left:84.5px;top:706.5px;line-height:0"></div>
<div class=line style="border-top-width:2px;left:86px;top:708px;right:421px;bottom:24px;line-height:0"></div>
<div style="border-bottom: 3px solid transparent;border-left-width: 6.5px;border-top: 3px solid transparent;left:211.5px;top:220px;line-height:0"></div>
<div class=line style="border-top-width:2px;left:83px;top:222px;right:424px;bottom:510px;line-height:0"></div>
<div style="border-bottom: 3px solid transparent;border-right-width: 6.5px;border-top: 3px solid transparent;left:84.5px;top:428.5px;line-height:0"></div>
<div class=line style="border-top-width:2px;left:86px;top:431px;right:421px;bottom:301px;line-height:0"></div>
<div class=line style="border-width:2px;border-top-width:0;-webkit-border-bottom-right-radius:4px;-moz-border-radius-bottomright:4px;border-bottom-right-radius:4px;-webkit-border-bottom-left-radius:4px;-moz-border-radius-bottomleft:4px;border-bottom-left-radius:4px;left:6px;top:386px;right:562px;bottom:331px"></div>
<div class=line style="border-width:2px;border-bottom-width:0;-webkit-border-top-right-radius:4px;-moz-border-radius-topright:4px;border-top-right-radius:4px;-webkit-border-top-left-radius:4px;-moz-border-radius-topleft:4px;border-top-left-radius:4px;left:6px;top:500px;right:562px;bottom:217px"></div>
<div style="border-bottom: 3px solid transparent;border-right-width: 6.5px;border-top: 3px solid transparent;left:84.5px;top:389px;line-height:0"></div>
<div class=line style="border-top-width:2px;left:86px;top:391px;right:421px;bottom:341px;line-height:0"></div>
<div style="border-bottom: 3px solid transparent;border-left-width: 6.5px;border-top: 3px solid transparent;left:211.5px;top:121px;line-height:0"></div>
<div class=line style="border-top-width:2px;left:83px;top:123px;right:424px;bottom:609px;line-height:0"></div>
<div class=line style="border-left-width:2px;left:309px;top:158px;right:329px;bottom:515px"></div>
<div style="border-bottom: 3px solid transparent;border-right-width: 6.5px;border-top: 3px solid transparent;left:84.5px;top:71.5px;line-height:0"></div>
<div class=line style="border-top-width:2px;left:86px;top:73px;right:421px;bottom:659px;line-height:0"></div>
<div style="border-bottom: 3px solid transparent;border-left-width: 6.5px;border-top: 3px solid transparent;left:211.5px;top:498px;line-height:0"></div>
<div class=line style="border-top-width:2px;left:83px;top:500px;right:424px;bottom:232px;line-height:0"></div>
<div style="border-bottom: 3px solid transparent;border-right-width: 6.5px;border-top: 3px solid transparent;left:84.5px;top:151px;line-height:0"></div>
<div class=line style="border-top-width:2px;left:86px;top:153px;right:421px;bottom:579px;line-height:0"></div>
<div style="border-bottom: 3px solid transparent;border-left-width: 6.5px;border-top: 3px solid transparent;left:618.5px;top:359px;line-height:0"></div>
<div class=line style="border-top-width:2px;left:440px;top:361px;right:17px;bottom:371px;line-height:0"></div>
<div class=line style="border-left-width:2px;left:631px;top:19px;right:7px;bottom:19px"></div>
<div class=line style="border-left-width:2px;left:309px;top:19px;right:329px;bottom:693px"></div>
<div class=line style="border-top-width:2px;border-right-width:2px;-webkit-border-top-right-radius:4px;-moz-border-radius-topright:4px;border-top-right-radius:4px;left:421px;top:292px;right:200px;bottom:366px"></div>
<div style="border-bottom: 3px solid transparent;border-right-width: 7px;border-top: 3px solid transparent;left:411.5px;top:389px;line-height:0"></div>
<div style="border-bottom: 3px solid transparent;border-left-width: 6.5px;border-top: 3px solid transparent;left:618.5px;top:389px;line-height:0"></div>
<div class=line style="border-top-width:2px;left:414px;top:391px;right:17px;bottom:341px;line-height:0"></div>
<div class=line style="border-width:2px;border-left-width:0;-webkit-border-top-right-radius:4px;-moz-border-radius-topright:4px;border-top-right-radius:4px;-webkit-border-bottom-right-radius:4px;-moz-border-radius-bottomright:4px;border-bottom-right-radius:4px;left:421px;top:569px;right:200px;bottom:53px"></div>
<div class=line style="border-left-width:2px;left:309px;top:584px;right:329px;bottom:58px"></div>
<div class=line style="border-bottom-width:2px;border-right-width:2px;-webkit-border-bottom-right-radius:4px;-moz-border-radius-bottomright:4px;border-bottom-right-radius:4px;left:42px;top:426px;right:562px;bottom:292px"></div>
<div class=line style="border-left-width:2px;border-bottom-width:2px;-webkit-border-bottom-left-radius:4px;-moz-border-radius-bottomleft:4px;border-bottom-left-radius:4px;left:6px;top:426px;right:598px;bottom:292px"></div>
<div class=line style="border-left-width:2px;left:309px;top:307px;right:329px;bottom:386px"></div>
<div style="border-bottom: 3px solid transparent;border-right-width: 7px;border-top: 3px solid transparent;left:406.5px;top:131px;line-height:0"></div>
<div style="border-bottom: 3px solid transparent;border-left-width: 6.5px;border-top: 3px solid transparent;left:613.5px;top:131px;line-height:0"></div>
<div class=line style="border-top-width:2px;left:409px;top:133px;right:22px;bottom:599px;line-height:0"></div>
<div class=line style="border-width:2px;border-bottom-width:0;-webkit-border-top-right-radius:4px;-moz-border-radius-topright:4px;border-top-right-radius:4px;-webkit-border-top-left-radius:4px;-moz-border-radius-topleft:4px;border-top-left-radius:4px;left:6px;top:351px;right:562px;bottom:366px"></div>
<div class=line style="border-width:2px;border-top-width:0;-webkit-border-bottom-right-radius:4px;-moz-border-radius-bottomright:4px;border-bottom-right-radius:4px;-webkit-border-bottom-left-radius:4px;-moz-border-radius-bottomleft:4px;border-bottom-left-radius:4px;left:6px;top:703px;right:562px;bottom:14px"></div>
<div style="text-align:center;left:298px;top:0px;right:313px;bottom:724px">HVX RM</div>
<div style="text-align:center;left:620px;top:0px;right:0px;bottom:724px">QURT</div>
<div style="text-align:center;left:248px;top:10px;right:268px;bottom:714px">(4 x 64B units available)</div>
<div style="text-align:center;left:84px;top:30px;right:442px;bottom:694px">qurt_hvx_try_lock(128B)</div>
<div style="text-align:center;left:7px;top:50px;right:568px;bottom:674px">PD0: Thread 1</div>
<div style="text-align:center;left:238px;top:50px;right:253px;bottom:674px">2 units locked by PD0 Thread 1</div>
<div style="text-align:center;left:481px;top:50px;right:55px;bottom:674px">Lock request/response</div>
<div style="text-align:center;left:104px;top:60px;right:476px;bottom:665px">Lock success</div>
<div style="left:317px;top:89px;right:199px;bottom:635px">(2 x 64B units available)</div>
<div style="text-align:center;left:84px;top:109px;right:442px;bottom:615px">qurt_hvx_try_lock(128B)</div>
<div style="text-align:center;left:481px;top:119px;right:55px;bottom:605px">Lock request/response</div>
<div style="text-align:center;left:7px;top:129px;right:568px;bottom:595px">PD0: Thread 2</div>
<div style="text-align:center;left:238px;top:129px;right:253px;bottom:595px">2 units locked by PD0 Thread 2</div>
<div style="text-align:center;left:104px;top:139px;right:476px;bottom:585px">Lock success</div>
<div style="left:317px;top:169px;right:228px;bottom:555px">(No unit available)</div>
<div style="text-align:center;left:84px;top:208px;right:442px;bottom:516px">qurt_hvx_try_lock(128B)</div>
<div style="text-align:center;left:10px;top:228px;right:566px;bottom:496px">PD1: Thread 1</div>
<div style="text-align:center;left:238px;top:228px;right:238px;bottom:496px">No unit is available to lock. Put</div>
<div style="text-align:center;left:241px;top:238px;right:241px;bottom:486px">the thread into a wait queue and</div>
<div style="text-align:center;left:238px;top:248px;right:238px;bottom:476px">dequeue when there is a free unit</div>
<div style="text-align:center;left:241px;top:258px;right:241px;bottom:466px">or when a timeout event happens.</div>
<div style="text-align:center;left:236px;top:278px;right:236px;bottom:446px">Uses timeout for qurt_hvx_try_lock</div>
<div style="left:238px;top:288px;right:278px;bottom:436px">corresponding to this PD.</div>
<div style="left:446px;top:288px;right:104px;bottom:436px">Timeout configured</div>
<div style="left:446px;top:317px;right:114px;bottom:407px">Timeout running.</div>
<div style="text-align:center;left:84px;top:337px;right:471px;bottom:387px">qurt_hvx_unlock()</div>
<div style="text-align:center;left:471px;top:347px;right:55px;bottom:377px">Unlock request/response</div>
<div style="text-align:center;left:10px;top:357px;right:566px;bottom:367px">PD0: Thread 1</div>
<div style="text-align:center;left:238px;top:357px;right:243px;bottom:367px">2 units are available, check the</div>
<div style="left:233px;top:367px;right:258px;bottom:357px">wait queue and assign the free</div>
<div style="left:461px;top:367px;right:89px;bottom:357px">Timeout cancelled.</div>
<div style="text-align:center;left:104px;top:377px;right:476px;bottom:347px">Lock success</div>
<div style="text-align:center;left:236px;top:377px;right:241px;bottom:347px">unit to the one waiting and reset</div>
<div style="text-align:center;left:481px;top:377px;right:55px;bottom:347px">Lock request/response</div>
<div style="text-align:center;left:10px;top:387px;right:566px;bottom:337px">PD1: Thread 1</div>
<div style="left:233px;top:387px;right:268px;bottom:337px">corresponding timeout event.</div>
<div style="text-align:center;left:104px;top:417px;right:466px;bottom:307px">Unlock success</div>
<div style="text-align:center;left:10px;top:427px;right:566px;bottom:298px">PD0: Thread 1</div>
<div style="left:317px;top:446px;right:228px;bottom:278px">(No unit available)</div>
<div style="text-align:center;left:84px;top:486px;right:442px;bottom:238px">qurt_hvx_try_lock(128B)</div>
<div style="text-align:center;left:10px;top:506px;right:566px;bottom:218px">PD0: Thread 1</div>
<div style="text-align:center;left:238px;top:506px;right:238px;bottom:218px">No unit is available to lock. Put</div>
<div style="text-align:center;left:241px;top:516px;right:241px;bottom:208px">the thread into a wait queue and</div>
<div style="text-align:center;left:238px;top:526px;right:238px;bottom:198px">dequeue when there is a free unit</div>
<div style="text-align:center;left:241px;top:536px;right:241px;bottom:188px">or when a timeout event happens.</div>
<div style="text-align:center;left:236px;top:556px;right:236px;bottom:169px">Uses timeout for qurt_hvx_try_lock</div>
<div style="left:238px;top:565px;right:278px;bottom:159px">corresponding to this PD.</div>
<div style="left:446px;top:565px;right:104px;bottom:159px">Timeout configured</div>
<div style="left:446px;top:615px;right:119px;bottom:109px">Timeout running</div>
<div style="left:446px;top:675px;right:149px;bottom:50px">Timed out</div>
<div style="text-align:center;left:241px;top:684px;right:241px;bottom:40px">Request timed out in wait queue.</div>
<div style="text-align:center;left:104px;top:694px;right:476px;bottom:30px">Lock failure</div>
<div style="left:238px;top:694px;right:268px;bottom:30px">Dequeue and return failure.</div>
<div style="text-align:center;left:10px;top:704px;right:566px;bottom:20px">PD0: Thread 1</div>
</div>
</div>
<h2>
<a name="HVX%20RM%20Configuration"></a>HVX RM Configuration
</h2><p>
HVX RM configuration parameters are stored in device configuration data of sysMon. This device configuration data is part of a CDSP build:
</p><p>
Device configuration XML file: <code>&lt;CDSP Build&gt;/cdsp_proc/performance/sysmon/config/660/sysmon_660_cdsp.xml</code>
</p><p>
Device configuration data file: <code>&lt;CDSP Build&gt;/cdsp_proc/performance/sysmon/config/660/sysmon_configdata_660_cdsp.c</code>
</p><h3>
<a name="HVX%20RM%20Enable%20field"></a>HVX RM Enable field
</h3><p>
HVX RM is enabled by default in SDM660 CDSP builds and can be disabled (if needed) by compiling corresponding CDSP build using the device configuration data of sysMon.
</p><pre><span style="color: darkgreen">//Device configuration XML file: &lt;CDSP Build&gt;/cdsp_proc/performance/sysmon/config/660/sysmon_660_cdsp.xml</span>
...
&lt;props name=<span style="color: darkred">"HVX_RESOURCE_MGR_ENABLE"</span> type=DALPROP_ATTR_TYPE_UINT32&gt;
    1
&lt;/props&gt;
...
</pre><p>
Modifying the <code>HVX_RESOURCE_MGR_ENABLE</code> property value to 0 (from 1) will disable HVX RM.
</p><h3>
<a name="Default%20timeout%20fields"></a>Default timeout fields
</h3><p>
There are default timeouts configured for each of the QuRT HVX lock calls i.e, qurt_hvx_lock and qurt_hvx_try_lock. Following methods can be used to override these default timeout values:
</p><ol type="1">
<li>
<p>
Compile time (needs CDSP build re-compilation):
</p><p>
Change device configuration data of sysMon providing desired timeout values for qurt_hvx_try_lock() / qurt_hvx_lock() calls and recompile the CDSP build.
</p><pre><span style="color: darkgreen">//Device configuration data file: &lt;CDSP Build&gt;/cdsp_proc/performance/sysmon/config/660/sysmon_configdata_660_cdsp.c</span>
...
<span style="color: blue">const</span> sd_hvx_rm_descriptor_t hvxRMDesc = {
    <span style="color: darkgreen">/* resThresPerc (&lt;100)   = */</span> 50,   <span style="color: darkgreen">//Threshold in percentage to be used in HVX reserve calls. Max 100.</span>
    <span style="color: darkgreen">/* tryLockTimeout        = */</span> 200,  <span style="color: darkgreen">//Default timeout in milli-seconds for qurt_hvx_try_lock() call</span>
    <span style="color: darkgreen">/* lockTimeout           = */</span> 200,  <span style="color: darkgreen">//Default timeout in milli-seconds for qurt_hvx_lock() call</span>
    <span style="color: darkgreen">/* obsWinDur             = */</span> 200,  <span style="color: darkgreen">//Observation window for tracking resource activity</span>
};
...
</pre>
</li><li>
<p>
Run time (per user process):
</p><p>
Use <code>int resmgr_hvx_config_update(resmgr_hvx_config_t* config)</code> API to override the defaults for the calling process/PD exposed under <code>&lt;Hexagon SDK&gt;\incs\hvx_resmgr.h</code>.
</p>
</li>
</ol><p>
Also, <code>int resmgr_hvx_lock_timeout(qurt_hvx_mode_t lock_mode, unsigned int timeout)</code> API is exposed under <code>&lt;Hexagon SDK&gt;\incs\hvx_resmgr.h</code> which accepts timeout value as a parameter instead of relying on the defaults. This can be used instead of qurt_hvx_lock() and qurt_hvx_try_lock() calls.
</p><h2>
<a name="Existing%20QuRT%20APIs%20and%20their%20behavior"></a>Existing QuRT APIs and their behavior
</h2><table><tr><th><p>
API
</p></th><th><p>
without HVX RM
</p></th><th><p>
with HVX RM
</p></th></tr><tr><td><p>
<b>qurt_hvx_lock</b>
</p></td><td><p>
Returns success if unit is free
</p><p>
(or)
</p><p>
Indefinite wait till free unit is available
</p></td><td><p>
Returns success if unit is free
</p><p>
(or)
</p><p>
Wait till a free unit is available until a timeout event is triggered. Returns success if a unit becomes available within timeout, failure otherwise.
</p></td></tr><tr><td><p>
<b>qurt_hvx_try_lock</b>
</p></td><td><p>
Retruns success if unit is free
</p><p>
(or)
</p><p>
Returns failure if no unit is free or on mode mismatch
</p><p>
(or)
</p></td><td><p>
Returns success if unit is free
</p><p>
(or)
</p><p>
Return failure if the unit being locked is of a different HVX mode then the current configured one.
</p><p>
(or)
</p><p>
Wait till a free unit is available until a timeout event is triggered. Returns success if a unit becomes available within timeout, failure otherwise.
</p></td></tr><tr><td><p>
<b>qurt_hvx_reserve</b>
</p></td><td><p>
Only one process can reserve. Returns failure for subsequent reserves called from other processes or from the same process.
</p></td><td><p>
Allows multiple reserves from different processes. Only allows one reserve per process. Returns success (with number of units) as long as total units reserved across processes are less than 4 (OR) if usage of requested HVX units is in limits (<b>resThresPerc</b>) in the observation window (<b>obsWinDur</b>). Returns failure otherwise.
</p><p>
<b>Note</b>: To allow concurrency, HVX reserve doesn't actually block the requested HVX units but treats the lock requests originating for the process with higher priority.
</p></td></tr></table><p>
Other QuRT HVX APIs functionality remains unchanged (Refer <code>qurt_hvx.h</code> file for all QuRT HVX APIs)
</p><h2>
<a name="Newly%20added%20APIs"></a>Newly added APIs
</h2><p>
The newly added APIs are valid only when HVX RM is enabled and are exposed using the header file at <code>&lt;Hexagon SDK&gt;\incs\hvx_resmgr.h</code>
</p><h3>
<a name="resmgr_hvx_lock_timeout"></a>resmgr_hvx_lock_timeout
</h3><p>
HVX lock with user provided timeout in micro-seconds. Provided timeout should be a multiple of 100, the API will internally round it to the nearest 100 micro-second multiple otherwise (&lt; 100 will be treated as 0).
</p><table><tr><th><p>
API
</p></th><td colspan="2"><p>
int <b>resmgr_hvx_lock_timeout</b>(qurt_hvx_mode_t <b>lock_mode</b>, unsigned int <b>timeout</b>)
</p></td></tr><tr><th><p>
Return
</p></th><td colspan="2"><p>
0 - for success, non-zero for failures
</p></td></tr><tr><th rowspan="2"><p>
Parameters
</p></th><td><p>
<b>lock_mode</b>
</p></td><td><p>
<b>qurt_hvx_mode_t</b> : Desired HVX mode
</p><pre><span style="color: darkgreen">//file: qurt_hvx.h                                                     </span>
...                                                                    
<span style="color: blue">typedef</span> <span style="color: blue">enum</span> {                                                         
    QURT_HVX_MODE_64B = 0,      <span style="color: darkgreen">/**&lt; HVX mode of 64 bytes */</span>           
    QURT_HVX_MODE_128B = 1      <span style="color: darkgreen">/**&lt; HVX mode of 128 bytes */</span>          
} qurt_hvx_mode_t;                                                     
...                                                                    
</pre></td></tr><tr><td><p>
<b>timeout</b>
</p></td><td><div class="indent"><p>
timeout value in micro-seconds (multiple of 100)
</p></div></td></tr></table><h4>
<a name="Example"></a>Example
</h4><pre><span style="color: darkgreen">//Acquire HVX lock on a 128B unit with a timeout of 3 milli-seconds</span>
<span style="color: blue">int</span> result = resmgr_hvx_lock_timeout(QURT_HVX_MODE_128B, 3000);
<span style="color: blue">if</span> (0 != result)
{
    <span style="color: darkgreen">//failed to allocate the resource. Return.</span>
    <span style="color: blue">return</span>;
}
<span style="color: darkgreen">//Successfully acquired HVX unit</span>

... <span style="color: darkgreen">//Do necessary operations</span>

<span style="color: darkgreen">//Release the unit once done</span>
qurt_hvx_unlock();
</pre><h3>
<a name="resmgr_hvx_config_update"></a>resmgr_hvx_config_update
</h3><p>
Overrides default timeouts for qurt_hvx_lock() and qurt_hvx_try_lock() calls with user provided values for the subsequent calls originating from the caller process.
</p><table><tr><th><p>
API
</p></th><td colspan="2"><p>
int <b>resmgr_hvx_config_update</b>(resmgr_hvx_config_t* <b>config</b>)
</p></td></tr><tr><th><p>
Return
</p></th><td colspan="2"><p>
0 - for success, non-zero for failures
</p></td></tr><tr><th><p>
Parameters
</p></th><td><p>
<b>config</b>
</p></td><td><p>
<b>resmgr_hvx_config_t*</b> : pointer to the configuration structure
</p><pre><span style="color: darkgreen">//file: hvx_resmgr.h                                                    </span>
...                                                                     
<span style="color: blue">typedef</span> <span style="color: blue">struct</span> {                                                        
    <span style="color: blue">unsigned</span> <span style="color: blue">char</span> bTryLockTimeout;                                      
    <span style="color: darkgreen">/**&lt; 1 - enable tryLockTimeout override                             
         0 - use default tryLockTimeout */</span>                              
    <span style="color: blue">unsigned</span> <span style="color: blue">int</span> tryLockTimeout;                                        
    <span style="color: darkgreen">/**&lt; Desired timeout for qurt_hvx_try_lock() API in micro seconds.  
         Will be honored only if btryLockTimeout == 1.                  
         Should be a multiple of 100 micro-seconds */</span>                   
    <span style="color: blue">unsigned</span> <span style="color: blue">char</span> bLockTimeout;                                         
    <span style="color: darkgreen">/**&lt; 1 - enable tryLockTimeout override                             
         0 - use default tryLockTimeout */</span>                              
    <span style="color: blue">unsigned</span> <span style="color: blue">int</span> lockTimeout;                                           
    <span style="color: darkgreen">/**&lt; Desired timeout for qurt_hvx_lock() API in micro seconds.      
         Will be honored only if bLockTimeout == 1.                     
         Should be a multiple of 100 micro-seconds */</span>                   
}resmgr_hvx_config_t;                                                   
...                                                                     
</pre></td></tr></table><h4>
<a name="_Example"></a>Example
</h4><pre><span style="color: darkgreen">/* Try acquiring a 64B HVX unit using default timeout */</span>
<span style="color: blue">int</span> result = qurt_hvx_try_lock(QURT_HVX_MODE_64B);
<span style="color: blue">if</span> (0 == result)
{
    <span style="color: darkgreen">/* Successfully acquired a HVX unit */</span>
    ...
    <span style="color: darkgreen">/* Release the acquired resource */</span>
    qurt_hvx_unlock();
}
<span style="color: darkgreen">/* Override default timeout for qurt_hvx_try_lock() calls while leaving the default timeout for qurt_hvx_lock() calls
 * originating from this user process */</span>
resmgr_hvx_config_t hvxRMConfig;
hvxRMConfig.bTryLockTimeout = 1;   <span style="color: darkgreen">//Enable qurt_hvx_try_lock() timeout override</span>
hvxRMConfig.tryLockTimeout = 3000; <span style="color: darkgreen">//3 milli-seconds timeout</span>
hvxRMConfig.bLockTimeout = 0; <span style="color: darkgreen">//Disable qurt_hvx_lock() timeout override i.e, use default timeout (from device configuration data)</span>
resmgr_hvx_config_update(&amp;hvxRMConfig);
...
<span style="color: blue">int</span> result = qurt_hvx_try_lock(QURT_HVX_MODE_64B);  <span style="color: darkgreen">//This lock call will use the new timeout of 3 milli-seconds as configured for this PD</span>
<span style="color: blue">if</span> (0 == result)
{
    <span style="color: darkgreen">/* Successfully acquired a HVX unit */</span>
    ...
    <span style="color: darkgreen">/* Release the acquired resource */</span>
    qurt_hvx_unlock();
}
...
<span style="color: darkgreen">/* Remove timeout override to fallback to the defaults */</span>
resmgr_hvx_config_t hvxRMConfig;
hvxRMConfig.bTryLockTimeout = 0;   <span style="color: darkgreen">//Disable qurt_hvx_try_lock() timeout override i.e, use default timeout from device configuration data</span>
hvxRMConfig.bLockTimeout = 0; <span style="color: darkgreen">//Disable qurt_hvx_lock() timeout override i.e, use default timeout from device configuration data</span>
resmgr_hvx_config_update(&amp;hvxRMConfig);
</pre><p align="center" style="display:block;padding-top: 50px;">
  Copyright &#169; 2018 Qualcomm Technologies Inc. All rights reserved.

</p><a style="display:block;padding-bottom: 700px;"></a></div></div>
</body>
</html>
