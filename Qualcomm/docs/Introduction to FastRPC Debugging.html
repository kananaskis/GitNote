<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta content="text/html;charset=utf-8" http-equiv="Content-Type">
<style type="text/css">
table {
   border-collapse: collapse;
   border-width: 1px;
   border-spacing: 1px;
   border-color: transparent;
   margin: 16px 0;
   width: 100%;
}
th {
   background-color: #bbb; color: white;
}
td, th {
   border-style: solid;
   border-color: black;
   border-width: 1px;
   padding: 0 6px;
}
td p:first-child, th p:first-child {
   margin-top: 3px;
}
td p:last-child, th p:last-child {
   margin-bottom: 3px;
}

.smarkdoc {
  margin-left: 42px; margin-right: 42px;
  font-size: 13px;
  font-family: 'Lucida Grande', Geneva, Helvetica, Arial, sans-serif;
}

h1, h2, h3 { color: #3c4c6c; }
h1 {
  text-align: center;
  font-size: 200%;
/*    margin-left: -30px; */
  clear: both;
}
h2 {
  font-size: 160%;
  margin: 32px -40px 24px -42px;
  padding: 3px 24px 8px;
  border-bottom: 2px solid #5088c5;
  clear: both;
}
h3 {
  font-size: 130%;
  margin: 20px -4px 10px;
  padding: 4px;
  clear: both;
}
h4 {
  font-size: 110%;
  margin: 2em 0 1em;
}

pre {
  font-size: 90%;
  background-color: #f0f0f4; padding: 6px; border: 1px solid #d0d0ee;
  font-family: "Courier New", "Lucida Console", "Monaco", monospace;
}

.pre {
  font-size: 90%;
  padding: 6px;
  background-color: #f0f0f4;
  font-family: "Courier New", "Lucida Console", "Monaco", monospace;
}

code {
  font-size: 90%;
  font-family: "Courier New", "Lucida Console", "Monaco", monospace;
}

h3 code {
  font-size: 100%;
}

p {
  margin: 0.8em 0;
}
ul, ol {
  margin: 1em 0 1em 3em; padding: 0;
}
div.indent {
  margin: 0 3em;
}

a[href] {
  text-decoration: none;
  color: #2020b0;
}
a[href]:hover {
  border-bottom: 1px dotted #2030d0;
}

/* Smark Users Guide */

.codebox {
  padding: 0 1px;  margin-right:1px;
  border:1px solid #d0d0ee;
  background-color: #f0f0f4;
  font-weight: bold;
  font-family: "Courier New", "Lucida Console", "Monaco", monospace;
}

/* ================ Smark-specific classes ================ */

.indent {
  margin: 0 3em;
}

/*
|| Floats affect text flow but not block boundaries, so graphics in a DIV
|| would overlap floats if not for "clear: both"
*/
.diagram {
  margin: 18px 0;
  clear: both;
}

/* ASCII Art */

.art {
  margin-right: auto; margin-left: auto; /* center */
  font-family: Arial, Verdana, "Lucida Console", Monaco, monospace;
  font-weight: bold;
}
.art * {
   border-color: #543;
}
.art .dline, .art .drect {
   border-style: dotted;
}
.art .rect {
   -webkit-box-shadow: 0.2em 0.2em 0.3em rgba(0,0,0,0.3);
   -moz-box-shadow: 0.2em 0.2em 0.3em rgba(0,0,0,0.3);
   box-shadow: 0.2em 0.2em 0.2em #875;
   background-color: #f9faf4; /* #fafff4; #f8f8ec;  */
}
.art .nofx {
   background-color: #f9faf4;
}
.art .round {
   border-radius: 0.6em;
   -webkit-border-radius: 0.6em;
   -moz-border-radius: 0.6em;
}

/* .art .line {  -webkit-box-shadow: 0.1em 0.1em 0.2em rgba(0,0,0,0.3); } */

/* Sequence Charts */

.msc {
   font: 11px Verdana, Monaco, "Lucida Console";
   margin-left: auto; margin-right: auto;
   background-color: white;
   /* border: 1px solid #555; */  /* Useful for non-white pages */
}

/* Table of Contents */

.tocLevel {
  margin-left: 2em;
  font-weight: normal;
}
.tocLevel .tocLevel {
  font-size: 90%; /* ...of inherited font size */
  line-height: 150%; /* ...of font size */
}
.toc > .tocLevel {
  font-weight: bold;
  margin: 0.5em 0
}
.toc {
  column-count: 2; column-gap: 2em;
  -moz-column-count: 2; -moz-column-gap: 2em;
  -webkit-column-count: 2; -webkit-column-gap: 2em;
}

/* ordinary text content is in P elements */

td p:first-child, th p:first-child {
   margin-top: 3px;
}
td p:last-child, th p:last-child {
   margin-bottom: 3px;
}
li p:only-child {
  margin-top: 0;
  margin-bottom: 0;
}

/* ================ Print ================ */

@media print {

  @page {
    margin: 0.75in 0.75in;
    size: Letter;
    @bottom {
      content: counter(page);
      vertical-align: top;
      padding-top: 1em;
    }
  }
  h1 { text-align: center;
       margin: 3in 0 20px; }
  h2 { page-break-before: always; }
  h2 { string-set: section content() }
  .toc { margin: 3em -2em }
  .toc a::after {
     font-size: 10px;
     content: leader(' . ') "  " target-counter(attr(href), page);
  }
  table { page-break-inside: avoid; }
}

/* ================  Layout  ================ */
/*
 *  +------------------------+
 *  |         #header        |
 *  +----------+-------------+
 *  | #sidebar |  #content   |
 *  |          |             |
 *  +----------+-------------+
 *
 * CSS padding, border width, and border style (!) affect the actual height
 * (and in turn layout).
 */

#header {
  position: fixed;
  top: 0px;
  height: 32px;
  left: 0px;
  width: 100%;
  padding: 10px 10px 0 0;
}
#sidebar {
  position: fixed;
  top: 42px;
  bottom: 0px;
  left: 0px;
  min-width: 180px;
  overflow: auto;
  border: 1px solid transparent;
  border-width: 0 1px 0 1px;
  padding: 0px 5px 0px 5px;
}
#content {
  position: fixed;
  top: 60px;
  left: 200px;
  bottom: 0px;
  right: 0px;
  overflow: auto;
  -webkit-overflow-scrolling: touch;
  padding: 10px 20px;
  padding-top: 0;
}

/* ================  Styles  ================ */


body {
  font-family: "Lucida Grande", Helvetica, Arial, sans-serif;
  font-size: 16px;
}

#header {
  color: #fff;
  background: #555;
  text-align: center;
  font-size: 25px;
}

#sidebar {
  color: #000;
  background: #eee;
  border-right: 1px solid #bbb;
  text-align: left;
  font-size: 12px;
  line-height: 50%;
}

#sidebar h1 {
  margin: 0 0 0 0;
  border-left: 5px solid transparent;
  text-align: left;
  font-size: 12px;
  /*text-shadow: #fff 1px 0px;*/
  line-height: 1%;
}

#sidebar h2 {
  margin: 2px 0 8px 0;
  border-left: 5px solid transparent;
  text-align: center;
  font-size: 12px;
  /*text-shadow: #fff 1px 0px;*/
  line-height: 1%;
}



#content {
  margin: 0;
  font-size: 13px;
  line-height: 160%;
}

#content h1, #content h2 {
  border-bottom: 2px solid;
  font-size: 1.8em;
  font-weight: normal;
  margin: 2.0em 0px 1.3em 0px;
  padding-bottom: 0.6em;
  text-align: left;
}

#content h3 {
  color: #242220;
  font-size: 1.4em;
  font-weight: normal;
  margin: 2em 0px 0.8em 0px;
  text-shadow: #FFFFFF 0px 1px 1px;
}
#content h4 {
  font-size: 1.2em;
  font-weight: normal;
  margin: 2em 0px 0.5em 0px;
  text-shadow: #FFFFFF 0px 1px 1px;
}

a[href] {
  color: #05c;
  text-decoration: none;
}

#sidebar a {
  /*text-shadow:  1px 1px 2px #fff, -1px -1px #ddd;*/
  line-height: 40%;
}

pre, code {
  font-family: "Courier New", "Lucida Console", "Monaco", monospace;
  font-family: "Monaco", monospace;  font-size: 90%;
  background-color: #f8f8fa;
  border: 1px solid #e4e4ee;
  -webkit-border-radius: 2px;
  -moz-border-radius: 2px;
  border-radius: 2px;
  padding: 1px 0 0 1px;
}

pre {
  padding: 2px 4px;
}

table {
   border-collapse: collapse;
   border-width: 1px;
   border-spacing: 1px;
   border-color: transparent;
   margin: 16px 0;
   width: 100%;
}
th {
   background-color: #bbb; color: white;
}
td, th {
   border-style: solid;
   border-color: black;
   border-width: 1px;
   padding: 0 6px;
}

/* Highlight currently-selected sidebar link */

#sidebar a.thisfile {
  color: #557;
}

/* indentation */

#content {
   padding-left: 60px;
}
#content h1, 
#content h2, 
#content h3, h4 {
    margin-left: -30px;
}

h3 > code {
    font-size: 80%;
}

/* ================ Smark-specific classes ================ */

.indent {
  margin: 0 3em;
}

/*
|| Floats affect text flow but not block boundaries, so graphics in a DIV 
|| would overlap floats if not for "clear: both"
*/
.diagram {
  margin: 18px 0;
  clear: both;
}

/* ASCII Art */

.art {
  margin-right: auto; margin-left: auto; /* center */
  font-family: Arial, Verdana, "Lucida Console", Monaco, monospace;
  font-weight: bold;
}
.art * {
   border-color: #543;
}
.art .dline, .art .drect {
   border-style: dotted;
}
.art .rect {
   -webkit-box-shadow: 0.2em 0.2em 0.3em rgba(0,0,0,0.3);
   -moz-box-shadow: 0.2em 0.2em 0.3em rgba(0,0,0,0.3);
   box-shadow: 0.2em 0.2em 0.2em #875;
   background-color: #f9faf4; /* #fafff4; #f8f8ec;  */
}
.art .nofx {
   background-color: #f9faf4;
}
.art .round {
   border-radius: 0.6em;
   -webkit-border-radius: 0.6em;
   -moz-border-radius: 0.6em;
}

/* Sequence Charts */

.msc {
   font: 11px Verdana, Monaco, "Lucida Console"; 
   margin-left: auto; margin-right: auto;
   background-color: white;
   border: 1px solid #555;
}

/* Table of Contents */

.tocLevel {
  margin-left: 2em;
  font-weight: normal;
}
.tocLevel .tocLevel {
  font-size: 90%; /* ...of inherited font size */
  line-height: 150%; /* ...of font size */
}
/*
.toc > .tocLevel {
  font-weight: bold;
  margin: 0.5em 0
}
*/

.toc {
  column-count: 1; column-gap: 2em;
  -moz-column-count: 1; -moz-column-gap: 2em;
  -webkit-column-count: 1; -webkit-column-gap: 2em; 
   alternate: column-width: 235px; column-rule-width: 5px;
}


.columns {
  column-count: 2; column-gap: 2em;
  -moz-column-count: 2; -moz-column-gap: 2em;
  -webkit-column-count: 2; -webkit-column-gap: 2em; p
}

/* ordinary text content is in P elements */

td p:first-child, th p:first-child {
   margin-top: 3px;
}
td p:last-child, th p:last-child {
   margin-bottom: 3px;
}
li p:only-child {
  margin-top: 0;
  margin-bottom: 0;
}


/* ================ Print ================ */

@media print {

  #header, #content { position: static; }
  #sidebar { display: none; }

  @page {
    margin: 0.75in 0.75in;
    size: Letter;
    @bottom {
      content: counter(page);
      vertical-align: top;
      padding-top: 1em;
    }
  }
  h1 { text-align: center;
       margin: 1in 0 1in; }
  h2 { page-break-before: always; }
  h2 { string-set: section content() }
  .toc { margin: 3em 0 }
  .toc a::after {
     font-size: 10px;
     content: leader(' . ') "  " target-counter(attr(href), page);
  }
  table { page-break-inside: avoid; }
}


</style><style type="text/css">
.search { right: 20pt; position: fixed; top: 5pt }

</style><title>FastRPC Debugging</title>
</head><body>
<div class="smarkdoc"><div id="header">Hexagon SDK 3.4.3</div><div id="sidebar"><top><img src="images/sidebar_top.jpg"></top><script src="scripts/post.js" type="text/javascript"></script><form class="search" id="searchForm"><input id="searchquery" name="q" onkeydown="postFunctionKeydown(event, false)"><input id="searchButton" onclick="postFunction(false)" type="button" value="Search"></form><p>
<a href="index.html">Quick start</a>
</p><hr>
<p>
<a href="feature_matrix.html">Feature Matrix</a>
</p><hr>
<p>
<a href="hexagon_architecture.html">Hexagon Architecture</a>
</p><hr>
<p>
<a href="images/Hexagon_Document_Bundle.pdf#page=2881">Hexagon Compiler/Linker</a>
</p><hr>
<p>
<a href="hexagon_libraries.html">Hexagon Standard Libraries</a>
</p><hr>
<p>
<a href="images/80-VB419-178_QuRT_User_Guide.pdf">Hexagon RTOS</a>
</p><hr>
<p>
<a href="images/80-VB419-108_Hexagon_DSP_User_Guide.pdf">Hexagon DSP Programming</a>
</p><hr>
<h3>
<a name="Platforms"></a>Platforms
</h3><p>
<a href="Platforms_HLOS.html">HLOS</a>
</p><p>
<a href="Platforms_Simulator.html">Simulator</a>
</p><p>
<a href="Platforms_Target.html">Target</a>
</p><hr>
<h3>
<a name="Environments"></a>Environments
</h3><p>
<a href="Environments_Build%20System.html">Build System</a>
</p><p>
<a href="Environments_Build%20System%20Porting.html">Build System Porting</a>
</p><p>
<a href="Environments_Hexagon%20IDE.html">Hexagon IDE</a>
</p><hr>
<h3>
<a name="ArchitectureOverview"></a>ArchitectureOverview
</h3><p>
<a href="HVX/ArchitectureOverview.html">HVX</a>
</p><hr>
<h3>
<a name="Applications"></a>Applications
</h3><p>
<a href="Audio/Applications.html">Audio</a>
</p><p>
<a href="Camera%20streaming/Applications.html">Camera streaming</a>
</p><p>
<a href="Applications_Compute%20offload.html">Compute offload</a>
</p><p>
<a href="FastCV/Applications_Computer%20Vision.html">Computer Vision</a>
</p><p>
<a href="Neural%20Networks/Applications.html">Neural Networks</a>
</p><p>
<a href="Voice/Applications.html">Voice</a>
</p><hr>
<h3>
<a name="APIs"></a>APIs
</h3><p>
<a href="APIs_Async%20Message%20Queue.html">Async Message Queue</a>
</p><p>
<a href="APIs_DSP%20Clk%20&amp;%20Rsrc%20Mgmt.html">DSP Clk &amp; Rsrc Mgmt</a>
</p><p>
<a href="APIs_Dynamic%20Loading.html">Dynamic Loading</a>
</p><p>
<a href="APIs_FastRPC.html">FastRPC</a>
</p><hr>
<h3>
<a name="Examples"></a>Examples
</h3><p>
<a href="Audio/Examples.html">Audio</a>
</p><p>
<a href="Camera%20streaming/Examples.html">Camera streaming</a>
</p><p>
<a href="Examples_Common.html">Common</a>
</p><p>
<a href="Examples_ComputeHVX.html">ComputeHVX</a>
</p><p>
<a href="Examples_GeneralOverview.html">GeneralOverview</a>
</p><p>
<a href="Neural%20Networks/Examples.html">Neural Networks</a>
</p><hr>
<h3>
<a name="Testing"></a>Testing
</h3><p>
<a href="CAPIv2/Testing_CAPIv2%20Unit%20Tests.html">CAPIv2 Unit Tests</a>
</p><p>
<a href="Testing_Eclipse%20Unit%20Tests.html">Eclipse Unit Tests</a>
</p><hr>
<h3>
<a name="Debugging"></a>Debugging
</h3><p>
<a href="Debugging_Connect%20to%20Device.html">Connect to Device</a>
</p><p>
<a href="Debugging_Exceptions.html">Exceptions</a>
</p><p>
<a href="Debugging_Message%20Logging.html">Message Logging</a>
</p><p>
<a href="Debugging_Simulator.html">Simulator</a>
</p><p>
<a href="Debugging_Target.html">Target</a>
</p><hr>
<h3>
<a name="Tools"></a>Tools
</h3><p>
<a href="Tools_Hexagon%20Tools%208.3.html">Hexagon Tools 8.3</a>
</p><p>
<a href="Tools_IDL%20Compiler.html">IDL Compiler</a>
</p><p>
<a href="Tools_On%20Target%20Profiling.html">On Target Profiling</a>
</p><p>
<a href="Tools_Scripts.html">Scripts</a>
</p><p>
<a href="Tools_Signing.html">Signing</a>
</p><p>
<a href="Tools_UserGuides.html">UserGuides</a>
</p><p>
<a href="Tools_Utilities.html">Utilities</a>
</p><hr>
<h3>
<a name="FAQ"></a>FAQ
</h3><p>
<a href="FAQ_Common.html">Common</a>
</p><p>
<a href="FAQ_Dynamic%20Loading.html">Dynamic Loading</a>
</p><p>
<a href="FAQ_FastRPC.html">FastRPC</a>
</p><p>
<a href="FAQ_Hexagon%20IDE.html">Hexagon IDE</a>
</p><hr>
<h3>
<a name="Dependencies"></a>Dependencies
</h3><p>
<a href="Dependencies_Common.html">Common</a>
</p><hr>
<h3>
<a name="Release%20Notes"></a>Release Notes
</h3><p>
<a href="Release%20Notes_Common.html">Common</a>
</p><hr>
<h3>
<a name="Support"></a>Support
</h3><p>
<a href="Support_Contact.html">Contact</a>
</p><center><img src="images/sidebar_bot.jpg"></center></div><div id="content"><a name="_top_" style="display:block;"></a><h1>
<a name="FastRPC%20Debugging"></a>FastRPC Debugging
</h1><div class="toc"><div class="tocLevel"><a href="#Introduction">Introduction</a></div><div class="tocLevel"><a href="#Error%20Analysis">Error Analysis</a><div class="tocLevel"><a href="#Operation%20not%20permitted">Operation not permitted</a></div><div class="tocLevel"><a href="#Transport%20endpoint%20not%20connected">Transport endpoint not connected</a></div><div class="tocLevel"><a href="#rpcmem_alloc%20Error">rpcmem_alloc Error</a></div><div class="tocLevel"><a href="#Sigverify%20failure">Sigverify failure</a></div><div class="tocLevel"><a href="#PD%20Creation%20failure">PD Creation failure</a></div><div class="tocLevel"><a href="#Error:%2039%20(27%20in%20hex)">Error: 39 (27 in hex)</a></div><div class="tocLevel"><a href="#Error:%2080000406">Error: 80000406</a></div><div class="tocLevel"><a href="#Error:%2080000402">Error: 80000402</a></div><div class="tocLevel"><a href="#Error:%208000040e">Error: 8000040e</a></div><div class="tocLevel"><a href="#Undefined%20PLT%20symbol">Undefined PLT symbol</a></div><div class="tocLevel"><a href="#Fopen%20failure">Fopen failure</a></div></div><div class="tocLevel"><a href="#Checking%20DSP%20State">Checking DSP State</a></div></div><h2>
<a name="Introduction"></a>Introduction
</h2><p>
For a FastRPC session between a client application on the apps processor and a service running on the DSP, error message logging is available from both the apps processor and the DSP. The messages from user space and kernel space on the apps processor are logged in logcat and dmesg respectively. The messages from DSP are logged to either mini-DM (please refer <a href="Debugging_Message%20Logging.html#mini-dm">mini-DM</a>) or in logcat (please refer <a href="Debugging_Message%20Logging.html#logcat">logcat</a>).
</p><p>
To search FastRPC errors from apps or dsp(adsp/cdsp/mdsp/slpi) on logcat, use following tag names: 'adsprpc' or '&lt;process name&gt;', e.g : adb logcat -s adsprpc.
</p><p>
To search FastRPC errors from dsp(adsp/cdsp/mdsp/slpi) on mini-DM, use following tag names: 'fastrpc', 'rtld', 'listener', 'sigverify', 'map_object', or 'mod_table'
</p><p>
If you don't find your error code here, then please refer <code>&lt;HEXAGON_SDK_ROOT&gt;\incs\stddef\AEEStdErr.h</code> file for complete list of error codes.
</p><h2>
<a name="Error%20Analysis"></a>Error Analysis
</h2><h3>
<a name="Operation%20not%20permitted"></a>Operation not permitted
</h3><pre>
Error ffffffff: apps_dev_init failed. &lt;domain 3&gt;, errno Operation not permitted
</pre><p>
This error is seen when FastRPC fails to open a session with DSP (or) fails to create a corresponding user process on DSP.
</p><ul>
<li>
<p>
Check whether DSP is up and running. Refer <a href="#Checking%20DSP%20State">Checking DSP State</a> section for details.
</p><p>
If DSP is not up and running, then please contact Customer Engineering(CE) Team.
</p>
</li><li>
<p>
Check whether the timestamp of fastrpc_shell_&lt;0/3&gt; file located on target at /dsp/&lt;adsp/cdsp&gt;/ (For Android P: /vendor/dsp/&lt;adsp/cdsp&gt;/) matches with timestamp of fastrpc_shell_&lt;0/3&gt; file on &lt;ADSP/CDSP&gt; image, located at &#8220;&lt;adsp_proc/cdsp_proc&gt;\build\dynamic_modules\670.cdsp.prod".
</p><div class="indent"><p>
If timestamp doesn't match, then flash ADSP/CDSP build again properly.
</p></div>
</li><li>
<p>
Check mini-DM logs for any errors during user PD creation.
</p>
</li>
</ul><h3>
<a name="Transport%20endpoint%20not%20connected"></a>Transport endpoint not connected
</h3><pre>
Error 0xffffffff: apps_dev_init failed for &lt;domain 0&gt;, errno Transport endpoint is not connected
</pre><p>
This error happens when DSP is not up. To check whether DSP is up and running, refer <a href="#Checking%20DSP%20State">Checking DSP State</a> section for details.
</p><p>
If DSP is not up and running, then please contact Customer Engineering(CE) Team.
</p><h3>
<a name="rpcmem_alloc%20Error"></a>rpcmem_alloc Error
</h3><pre>
adsprpc : src/rpcmem_android.c:284::error: -1: 0 &lt;= ioctl(rpcmem_ionfd, ION_IOC_ALLOC_KK, &amp;alloc)
adsprpc : src/rpcmem_android.c:158:rpcmem jb allocation error: -1: trying ics
adsprpc : src/rpcmem_android.c:329::error: -1: 0 &lt;= ioctl(rpcmem_ionfd, ION_IOC_ALLOC_ICS, &amp;alloc)
adsprpc : src/rpcmem_android.c:159::error: -1: 0 == (nErr = rpcmem_contig_alloc_ics(m, heap_mask, size, &amp;po))
</pre><p>
Above errors will be seen if you are using SDK version 3.3.3 for SM8150 or any later device.
</p><p>
FastRPC's rpcmem module has been updated in SDK 3.4.0 for SM8150, due to ION upgrade.
</p><ul>
<li>
<p>
So, if you see above errors on logcat and if you are using SM8150 or any later device, then please update your SDK to 3.4.0 or later.
</p>
</li>
</ul><h3>
<a name="Sigverify%20failure"></a>Sigverify failure
</h3><pre>
1) CDSP: signature verify start failed for &lt;xxxx&gt;_skel.so
</pre><p>
Above error is seen when signature file(testsig-&lt;xxxx&gt;.so) for the particular target is not found. This file is needed to run dynamic shared object(&lt;xxxx&gt;_skel.so) on DSP.
</p><p>
Please check for the steps given below:
</p><ul>
<li>
<p>
Check whether testsig-&lt;xxxx&gt;.so is present in the ADSP_LIBRARY_PATH environment variable (which the user is free to re-define). The default search paths are:
</p><div class="indent"><p>
ADSP_LIBRARY_PATH=';/system/lib/rfsa/adsp;/system/vendor/lib/rfsa/adsp;/dsp';
</p></div>
</li><li>
<p>
If testsig-&lt;xxxx&gt;.so is present, then check whether the serial number for the generated testsig and the device matches
</p><div class="indent"><p>
The testsig-&lt;xxxx&gt;.so file name contains the serial number in hexadecimal format, for e.g. <code>testsig-&lt;0x980162fc&gt;.so</code> This serial number should match with the device serial number, which can be obtained by pushing getserial application from SDK. Please refer <a href="Tools_Signing.html#Obtaining%20Device%20Serial%20Number">Get Device Serial Number</a> document for details.
</p></div>
</li><li>
<p>
If testsig-&lt;xxxx&gt;.so is not present, then please refer <a href="Tools_Signing.html#TestSigs">Signing the Device</a> document for details.
</p>
</li>
</ul><pre>
2) [sigverify.c    552] 00: CDSP:failed to finalize verify segment &lt;15 9b d6&gt;  vs &lt;pHash:C01FC1E1&gt;
[map_object.c    805] 00: CDSP:Segment [0] failed streamed SigVerify for fastrpc_shell_&lt;0/3&gt;
</pre><p>
Above error is seen when there is a mismatch between FastRPC shell on target and &lt;ADSP/CDSP&gt; image.
</p><ul>
<li>
<p>
Check whether the timestamp of fastrpc_shell_&lt;0/3&gt; file located on target at /dsp/&lt;adsp/cdsp&gt;/ (For Android P: /vendor/dsp/&lt;adsp/cdsp&gt;/) matches with timestamp of fastrpc_shell_&lt;0/3&gt; file on &lt;ADSP/CDSP&gt; image, located at &#8220;&lt;adsp_proc/cdsp_proc&gt;\build\dynamic_modules\670.cdsp.prod".
</p><div class="indent"><p>
If timestamp doesn't match, then flash ADSP/CDSP build again properly.
</p></div>
</li>
</ul><h3>
<a name="PD%20Creation%20failure"></a>PD Creation failure
</h3><pre>
[fastrpc_loader.c    577] 00: CDSP:Error ffffffff(0): loading process failed for &lt;/frpc/c03f9430 calculator&gt;
[fastrpc_loader.c    814] 00: CDSP: spawn for &lt;calculator&gt; failed
</pre><p>
Generally PD is created during the first remote call made to DSP. If you see above errors from DSP, check for the below steps:
</p><ul>
<li>
<p>
PD creation can fail if there is no permission to access fastrpc_shell_&lt;0/3&gt; file located on target at /dsp/&lt;adsp/cdsp&gt;/ (For Android P: /vendor/dsp/&lt;adsp/cdsp&gt;/)
</p>
</li><li>
<p>
PD creation can also fail because of file read failures on HLOS.
</p><div class="indent"><p>
Check for the avc denial errors in kernel logs.
</p><div class="indent"><p>
for ex: Below avc denial errors are for /dsp folder.
</p><p>
dmesg: 'avc: denied { open } for pid=10222 comm='XXXXXXXXX' path='/dsp/fastrpc_shell_0' dev='sdd7' ino=26 scontext=u:r:xxxxxxxx:s0 tcontext=u:object_r:unlabeled:s0 tclass=file permissive=1 SEPF_SECMOBILE_7.0_0002'
</p></div><p>
If above errors are found, check whether Selinux policy is defined properly for your process.
</p><div class="indent"><p>
For example: For cameraserver process to be able to access a particular directory, following entry should be there in cameraserver.te file: (located at &#8220;&lt;HLOS_Build&gt;/device/qcom/sepolicy/vendor/common/cameraserver.te&#8221;) <code>r_dir_file(cameraserver, adsprpcd_file);</code> (#allow cameraserver to access /dsp)
</p></div></div>
</li><li>
<p>
PD creation can fail if the fastrpc_shell does not match the flashed DSP image. If you see errors as below in QXDM or mini-dm:
</p>
</li>
</ul><pre>[sigverify.c         552] 00: CDSP:failed to finalize verify segment 31 f1 27  vs pHash:C01FE271
[map_object.c        405] 00: CDSP:Streaming Hash Finalize error
[map_object.c        410] 00: CDSP:Error: pared thread failed: segnum 0
[map_object.c        805] 00: CDSP:Segment [0] failed streamed SigVerify for fastrpc_shell_3
[fastrpc_loader.c    577] 00: CDSP:Error ffffffff(0): loading process failed for &lt;/frpc/c0415ca0 calculator&gt;
[stdout                1] 00: CDSP:SPAWN FAILED: process failed to load
</pre><p>
Check whether the timestamp of fastrpc_shell_&lt;0/3&gt; file located on target at /dsp/&lt;adsp/cdsp&gt;/ (For Android P: /vendor/dsp/&lt;adsp/cdsp&gt;/) matches with timestamp of fastrpc_shell_&lt;0/3&gt; file on &lt;ADSP/CDSP&gt; image, located at &#8220;&lt;adsp_proc/cdsp_proc&gt;\build\dynamic_modules&lt;670&gt;.cdsp.prod". If timestamp doesn't match, then flash ADSP/CDSP build again properly.
</p><h3>
<a name="Error:%2039%20(27%20in%20hex)"></a>Error: 39 (27 in hex)
</h3><pre>
Error 27: remote handle invoke failed. &lt;domain 3, handle 3, sc 4020200, pra 0x72b7cc13f8&gt;
AEE_ENOSUCH = 39 (0x27)
</pre><p>
Above error means an exception occurred in user process on DSP domain 3 (CDSP) and user process got killed.
</p><div class="indent"><p>
Further FastRPC calls will return the same error code 39. Clients are expected to handle this error code and restart the session.
</p><ul>
<li>
<p>
If you are using SM8150 or any later device, then please refer <a href="Debugging_Exceptions.html">Crash Details</a> document for getting the crash details.
</p>
</li><li>
<p>
If you are using a device prior to SM8150, then the only way to debug user exceptions through SDK is using remote debugger on DSP. Please refer <a href="Debugging_Target.html">Remote Debugging</a> document for details.
</p>
</li>
</ul></div><p>
This error may also be seen if you are using a shared object that is built with invalid architecture.
</p><div class="indent"><p>
Please check below for Hexagon version details for your target.
</p><pre>
Target            -           Hexagon Version 
MSM8996           -           V60 
MSM8998           -           V62
SDM660            -           V62(aDSP) V60(cDSP) 
SDM670            -           V65
SDM845            -           V65
SM7150            -           V65
SM6150            -           V66
SM8150            -           V66
QCS405            -           V66
</pre></div><h3>
<a name="Error:%2080000406"></a>Error: 80000406
</h3><pre>
Error 80000406: remote handle open domain failed.&lt;domain 2, name adspmsgd_adsp&gt;, dlerror cannot open &lt;xxxxx&gt;_skel.so
AEE_EUNABLETOLOAD
</pre><p>
This error is seen when the process failed to load the shared object on DSP.
</p><ul>
<li>
<p>
Check that shared object files are present on target in the directories defined by ADSP_LIBRARY_PATH environment variable (which the user is free to re-define). The default search paths are:
</p><div class="indent"><p>
ADSP_LIBRARY_PATH=';/system/lib/rfsa/adsp;/system/vendor/lib/rfsa/adsp;/dsp';
</p></div>
</li><li>
<p>
This error can also be seen if the process doesn't have permissions to access the directory in which shared object files are present.
</p><div class="indent"><p>
Check for the avc denial errors in kernel logs.
</p><div class="indent"><p>
for ex: Below avc denial errors are for /dsp folder.
</p><p>
dmesg: 'avc: denied { open } for pid=10222 comm='XXXXXXXXX' path='/dsp/fastrpc_shell_0' dev='sdd7' ino=26 scontext=u:r:xxxxxxxx:s0 tcontext=u:object_r:unlabeled:s0 tclass=file permissive=1 SEPF_SECMOBILE_7.0_0002'
</p></div><p>
If above errors are found, check whether Selinux policy is defined properly for your process.
</p><div class="indent"><p>
For example: For cameraserver process to be able to access a particular directory, following entry should be there in cameraserver.te file: (located at &#8220;&lt;HLOS_Build&gt;/device/qcom/sepolicy/vendor/common/cameraserver.te&#8221;) <code>r_dir_file(cameraserver, adsprpcd_file);</code> (#allow cameraserver to access /dsp)
</p></div></div>
</li><li>
<p>
Check mini-DM logs for any dlopen errors.
</p>
</li>
</ul><h3>
<a name="Error:%2080000402"></a>Error: 80000402
</h3><pre>
Error 80000402: remote handle invoke failed. &lt;domain 3, handle b89040f0, sc 3020200, pra 0x85205698&gt;
AEE_ENOMEMORY = 0x80000402
</pre><p>
This error indicates that there is not enough memory in FastRPC Heap to allocate memory for stack allocation and thread creation in the userPD on DSP.
</p><p>
If you see above errors, then please contact FastRPC Support Team/Customer Engineering(CE) Team.
</p><h3>
<a name="Error:%208000040e"></a>Error: 8000040e
</h3><pre>
CDSP: Error:8000040e open_mod_table_handle_invoke failed for &lt;handle 7d203f50 sc 8010000 0714&gt; mod_table.c
AEE_EBADPARM = 0x8000040e
</pre><p>
This error happens when wrong parameters are passed to the Skel function.
</p><p>
This can also happen due to the mismatch between Stub and Skel files.
</p><ul>
<li>
<p>
Check that proper Stub and Skel files are pushed to the target and if any duplicate copies exist in directories defined by ADSP_LIBRARY_PATH environment variable (which the user is free to re-define). The default search paths are:
</p><div class="indent"><p>
ADSP_LIBRARY_PATH=';/system/lib/rfsa/adsp;/system/vendor/lib/rfsa/adsp;/dsp';
</p></div>
</li>
</ul><h3>
<a name="Undefined%20PLT%20symbol"></a>Undefined PLT symbol
</h3><pre>
dlopen error:&lt;file:///libsysmondomain_skel.so?sysmondomain_skel_handle_invoke&amp;_modver=1.0&amp;_dom=sdsp&gt; undefined symbol PLT
</pre><p>
This error comes from DSP, when a symbol is used in shared object but not exposed in FastRPC shell.
</p><p>
This error can also be seen if the symbol belongs to shared object but its definition is missing.
</p><h3>
<a name="Fopen%20failure"></a>Fopen failure
</h3><pre>
Error 45: fopen failed for &lt;xxxxx&gt;_skel.so (No such file or directory)
</pre><p>
If you see Fopen failure messages like above in logcat, then follow the below steps:
</p><ul>
<li>
<p>
Check that the file &#8220;&lt;xxxxx&gt;_skel.so&#8221; is present on target in the directories defined by ADSP_LIBRARY_PATH environment variable (which the user is free to re-define). The default search paths are:
</p><div class="indent"><p>
ADSP_LIBRARY_PATH=';/system/lib/rfsa/adsp;/system/vendor/lib/rfsa/adsp;/dsp';
</p></div>
</li><li>
<p>
Check whether Selinux policy is defined properly for your process.
</p><div class="indent"><p>
For example: For cameraserver process to be able to access a particular directory, following entry should be there in cameraserver.te file: (located at &#8220;&lt;HLOS_Build&gt;/device/qcom/sepolicy/vendor/common/cameraserver.te&#8221;)
</p><div class="indent"><p>
<code>r_dir_file(cameraserver, adsprpcd_file);</code> (#allow cameraserver to access /dsp)
</p></div></div>
</li>
</ul><h2>
<a name="Checking%20DSP%20State"></a>Checking DSP State
</h2><p>
To check whether DSP is up and running use any one of the two ways mentioned below:
</p><ol type="1">
<li>
<p>
Check whether DSP is brought out of reset. If DSP is up then below messages will get logged in kernel(serial port) logs:
</p><div class="indent"><p>
[ 23.314302] subsys-pil-tz 62400000.qcom,lpass: adsp: loading from 0x0000000093e00000 to 0x0000000095c00000
</p><p>
[ 23.751586] subsys-pil-tz 62400000.qcom,lpass: adsp: Brought out of reset
</p><p>
[ 23.794788] subsys-pil-tz 62400000.qcom,lpass: adsp: Power/Clock ready interrupt received
</p></div>
</li><li>
<p>
You can also check for state of DSP with the help of below commands:
</p><div class="indent"><p>
Find the proper subsystem node for ADSP: <code>adb shell cat /sys/bus/msm_subsys/devices/subsys&lt;1/2/3/4&gt;/name</code> should show &#8220;adsp/cdsp&#8221;.
</p><p>
Then run <code>adb shell cat /sys/bus/msm_subsys/devices/subsys&lt;1/2/3/4&gt;/state</code> to find whether it is &#8220;ONLINE&#8221;.
</p></div>
</li>
</ol><p align="center" style="display:block;padding-top: 50px;">
  Copyright &#169; 2018 Qualcomm Technologies Inc. All rights reserved.

</p><a style="display:block;padding-bottom: 700px;"></a></div></div>
</body>
</html>
