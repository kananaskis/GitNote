<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta content="text/html;charset=utf-8" http-equiv="Content-Type">
<style type="text/css">
table {
   border-collapse: collapse;
   border-width: 1px;
   border-spacing: 1px;
   border-color: transparent;
   margin: 16px 0;
   width: 100%;
}
th {
   background-color: #bbb; color: white;
}
td, th {
   border-style: solid;
   border-color: black;
   border-width: 1px;
   padding: 0 6px;
}
td p:first-child, th p:first-child {
   margin-top: 3px;
}
td p:last-child, th p:last-child {
   margin-bottom: 3px;
}

.smarkdoc {
  margin-left: 42px; margin-right: 42px;
  font-size: 13px;
  font-family: 'Lucida Grande', Geneva, Helvetica, Arial, sans-serif;
}

h1, h2, h3 { color: #3c4c6c; }
h1 {
  text-align: center;
  font-size: 200%;
/*    margin-left: -30px; */
  clear: both;
}
h2 {
  font-size: 160%;
  margin: 32px -40px 24px -42px;
  padding: 3px 24px 8px;
  border-bottom: 2px solid #5088c5;
  clear: both;
}
h3 {
  font-size: 130%;
  margin: 20px -4px 10px;
  padding: 4px;
  clear: both;
}
h4 {
  font-size: 110%;
  margin: 2em 0 1em;
}

pre {
  font-size: 90%;
  background-color: #f0f0f4; padding: 6px; border: 1px solid #d0d0ee;
  font-family: "Courier New", "Lucida Console", "Monaco", monospace;
}

.pre {
  font-size: 90%;
  padding: 6px;
  background-color: #f0f0f4;
  font-family: "Courier New", "Lucida Console", "Monaco", monospace;
}

code {
  font-size: 90%;
  font-family: "Courier New", "Lucida Console", "Monaco", monospace;
}

h3 code {
  font-size: 100%;
}

p {
  margin: 0.8em 0;
}
ul, ol {
  margin: 1em 0 1em 3em; padding: 0;
}
div.indent {
  margin: 0 3em;
}

a[href] {
  text-decoration: none;
  color: #2020b0;
}
a[href]:hover {
  border-bottom: 1px dotted #2030d0;
}

/* Smark Users Guide */

.codebox {
  padding: 0 1px;  margin-right:1px;
  border:1px solid #d0d0ee;
  background-color: #f0f0f4;
  font-weight: bold;
  font-family: "Courier New", "Lucida Console", "Monaco", monospace;
}

/* ================ Smark-specific classes ================ */

.indent {
  margin: 0 3em;
}

/*
|| Floats affect text flow but not block boundaries, so graphics in a DIV
|| would overlap floats if not for "clear: both"
*/
.diagram {
  margin: 18px 0;
  clear: both;
}

/* ASCII Art */

.art {
  margin-right: auto; margin-left: auto; /* center */
  font-family: Arial, Verdana, "Lucida Console", Monaco, monospace;
  font-weight: bold;
}
.art * {
   border-color: #543;
}
.art .dline, .art .drect {
   border-style: dotted;
}
.art .rect {
   -webkit-box-shadow: 0.2em 0.2em 0.3em rgba(0,0,0,0.3);
   -moz-box-shadow: 0.2em 0.2em 0.3em rgba(0,0,0,0.3);
   box-shadow: 0.2em 0.2em 0.2em #875;
   background-color: #f9faf4; /* #fafff4; #f8f8ec;  */
}
.art .nofx {
   background-color: #f9faf4;
}
.art .round {
   border-radius: 0.6em;
   -webkit-border-radius: 0.6em;
   -moz-border-radius: 0.6em;
}

/* .art .line {  -webkit-box-shadow: 0.1em 0.1em 0.2em rgba(0,0,0,0.3); } */

/* Sequence Charts */

.msc {
   font: 11px Verdana, Monaco, "Lucida Console";
   margin-left: auto; margin-right: auto;
   background-color: white;
   /* border: 1px solid #555; */  /* Useful for non-white pages */
}

/* Table of Contents */

.tocLevel {
  margin-left: 2em;
  font-weight: normal;
}
.tocLevel .tocLevel {
  font-size: 90%; /* ...of inherited font size */
  line-height: 150%; /* ...of font size */
}
.toc > .tocLevel {
  font-weight: bold;
  margin: 0.5em 0
}
.toc {
  column-count: 2; column-gap: 2em;
  -moz-column-count: 2; -moz-column-gap: 2em;
  -webkit-column-count: 2; -webkit-column-gap: 2em;
}

/* ordinary text content is in P elements */

td p:first-child, th p:first-child {
   margin-top: 3px;
}
td p:last-child, th p:last-child {
   margin-bottom: 3px;
}
li p:only-child {
  margin-top: 0;
  margin-bottom: 0;
}

/* ================ Print ================ */

@media print {

  @page {
    margin: 0.75in 0.75in;
    size: Letter;
    @bottom {
      content: counter(page);
      vertical-align: top;
      padding-top: 1em;
    }
  }
  h1 { text-align: center;
       margin: 3in 0 20px; }
  h2 { page-break-before: always; }
  h2 { string-set: section content() }
  .toc { margin: 3em -2em }
  .toc a::after {
     font-size: 10px;
     content: leader(' . ') "  " target-counter(attr(href), page);
  }
  table { page-break-inside: avoid; }
}

/* ================  Layout  ================ */
/*
 *  +------------------------+
 *  |         #header        |
 *  +----------+-------------+
 *  | #sidebar |  #content   |
 *  |          |             |
 *  +----------+-------------+
 *
 * CSS padding, border width, and border style (!) affect the actual height
 * (and in turn layout).
 */

#header {
  position: fixed;
  top: 0px;
  height: 32px;
  left: 0px;
  width: 100%;
  padding: 10px 10px 0 0;
}
#sidebar {
  position: fixed;
  top: 42px;
  bottom: 0px;
  left: 0px;
  min-width: 180px;
  overflow: auto;
  border: 1px solid transparent;
  border-width: 0 1px 0 1px;
  padding: 0px 5px 0px 5px;
}
#content {
  position: fixed;
  top: 60px;
  left: 200px;
  bottom: 0px;
  right: 0px;
  overflow: auto;
  -webkit-overflow-scrolling: touch;
  padding: 10px 20px;
  padding-top: 0;
}

/* ================  Styles  ================ */


body {
  font-family: "Lucida Grande", Helvetica, Arial, sans-serif;
  font-size: 16px;
}

#header {
  color: #fff;
  background: #555;
  text-align: center;
  font-size: 25px;
}

#sidebar {
  color: #000;
  background: #eee;
  border-right: 1px solid #bbb;
  text-align: left;
  font-size: 12px;
  line-height: 50%;
}

#sidebar h1 {
  margin: 0 0 0 0;
  border-left: 5px solid transparent;
  text-align: left;
  font-size: 12px;
  /*text-shadow: #fff 1px 0px;*/
  line-height: 1%;
}

#sidebar h2 {
  margin: 2px 0 8px 0;
  border-left: 5px solid transparent;
  text-align: center;
  font-size: 12px;
  /*text-shadow: #fff 1px 0px;*/
  line-height: 1%;
}



#content {
  margin: 0;
  font-size: 13px;
  line-height: 160%;
}

#content h1, #content h2 {
  border-bottom: 2px solid;
  font-size: 1.8em;
  font-weight: normal;
  margin: 2.0em 0px 1.3em 0px;
  padding-bottom: 0.6em;
  text-align: left;
}

#content h3 {
  color: #242220;
  font-size: 1.4em;
  font-weight: normal;
  margin: 2em 0px 0.8em 0px;
  text-shadow: #FFFFFF 0px 1px 1px;
}
#content h4 {
  font-size: 1.2em;
  font-weight: normal;
  margin: 2em 0px 0.5em 0px;
  text-shadow: #FFFFFF 0px 1px 1px;
}

a[href] {
  color: #05c;
  text-decoration: none;
}

#sidebar a {
  /*text-shadow:  1px 1px 2px #fff, -1px -1px #ddd;*/
  line-height: 40%;
}

pre, code {
  font-family: "Courier New", "Lucida Console", "Monaco", monospace;
  font-family: "Monaco", monospace;  font-size: 90%;
  background-color: #f8f8fa;
  border: 1px solid #e4e4ee;
  -webkit-border-radius: 2px;
  -moz-border-radius: 2px;
  border-radius: 2px;
  padding: 1px 0 0 1px;
}

pre {
  padding: 2px 4px;
}

table {
   border-collapse: collapse;
   border-width: 1px;
   border-spacing: 1px;
   border-color: transparent;
   margin: 16px 0;
   width: 100%;
}
th {
   background-color: #bbb; color: white;
}
td, th {
   border-style: solid;
   border-color: black;
   border-width: 1px;
   padding: 0 6px;
}

/* Highlight currently-selected sidebar link */

#sidebar a.thisfile {
  color: #557;
}

/* indentation */

#content {
   padding-left: 60px;
}
#content h1, 
#content h2, 
#content h3, h4 {
    margin-left: -30px;
}

h3 > code {
    font-size: 80%;
}

/* ================ Smark-specific classes ================ */

.indent {
  margin: 0 3em;
}

/*
|| Floats affect text flow but not block boundaries, so graphics in a DIV 
|| would overlap floats if not for "clear: both"
*/
.diagram {
  margin: 18px 0;
  clear: both;
}

/* ASCII Art */

.art {
  margin-right: auto; margin-left: auto; /* center */
  font-family: Arial, Verdana, "Lucida Console", Monaco, monospace;
  font-weight: bold;
}
.art * {
   border-color: #543;
}
.art .dline, .art .drect {
   border-style: dotted;
}
.art .rect {
   -webkit-box-shadow: 0.2em 0.2em 0.3em rgba(0,0,0,0.3);
   -moz-box-shadow: 0.2em 0.2em 0.3em rgba(0,0,0,0.3);
   box-shadow: 0.2em 0.2em 0.2em #875;
   background-color: #f9faf4; /* #fafff4; #f8f8ec;  */
}
.art .nofx {
   background-color: #f9faf4;
}
.art .round {
   border-radius: 0.6em;
   -webkit-border-radius: 0.6em;
   -moz-border-radius: 0.6em;
}

/* Sequence Charts */

.msc {
   font: 11px Verdana, Monaco, "Lucida Console"; 
   margin-left: auto; margin-right: auto;
   background-color: white;
   border: 1px solid #555;
}

/* Table of Contents */

.tocLevel {
  margin-left: 2em;
  font-weight: normal;
}
.tocLevel .tocLevel {
  font-size: 90%; /* ...of inherited font size */
  line-height: 150%; /* ...of font size */
}
/*
.toc > .tocLevel {
  font-weight: bold;
  margin: 0.5em 0
}
*/

.toc {
  column-count: 1; column-gap: 2em;
  -moz-column-count: 1; -moz-column-gap: 2em;
  -webkit-column-count: 1; -webkit-column-gap: 2em; 
   alternate: column-width: 235px; column-rule-width: 5px;
}


.columns {
  column-count: 2; column-gap: 2em;
  -moz-column-count: 2; -moz-column-gap: 2em;
  -webkit-column-count: 2; -webkit-column-gap: 2em; p
}

/* ordinary text content is in P elements */

td p:first-child, th p:first-child {
   margin-top: 3px;
}
td p:last-child, th p:last-child {
   margin-bottom: 3px;
}
li p:only-child {
  margin-top: 0;
  margin-bottom: 0;
}


/* ================ Print ================ */

@media print {

  #header, #content { position: static; }
  #sidebar { display: none; }

  @page {
    margin: 0.75in 0.75in;
    size: Letter;
    @bottom {
      content: counter(page);
      vertical-align: top;
      padding-top: 1em;
    }
  }
  h1 { text-align: center;
       margin: 1in 0 1in; }
  h2 { page-break-before: always; }
  h2 { string-set: section content() }
  .toc { margin: 3em 0 }
  .toc a::after {
     font-size: 10px;
     content: leader(' . ') "  " target-counter(attr(href), page);
  }
  table { page-break-inside: avoid; }
}


</style><style type="text/css">
.search { right: 20pt; position: fixed; top: 5pt }

</style><title>Signing</title>
</head><body>
<div class="smarkdoc"><div id="header">Hexagon SDK 3.4.3</div><div id="sidebar"><top><img src="images/sidebar_top.jpg"></top><script src="scripts/post.js" type="text/javascript"></script><form class="search" id="searchForm"><input id="searchquery" name="q" onkeydown="postFunctionKeydown(event, false)"><input id="searchButton" onclick="postFunction(false)" type="button" value="Search"></form><p>
<a href="index.html">Quick start</a>
</p><hr>
<p>
<a href="feature_matrix.html">Feature Matrix</a>
</p><hr>
<p>
<a href="hexagon_architecture.html">Hexagon Architecture</a>
</p><hr>
<p>
<a href="images/Hexagon_Document_Bundle.pdf#page=2881">Hexagon Compiler/Linker</a>
</p><hr>
<p>
<a href="hexagon_libraries.html">Hexagon Standard Libraries</a>
</p><hr>
<p>
<a href="images/80-VB419-178_QuRT_User_Guide.pdf">Hexagon RTOS</a>
</p><hr>
<p>
<a href="images/80-VB419-108_Hexagon_DSP_User_Guide.pdf">Hexagon DSP Programming</a>
</p><hr>
<h3>
<a name="Platforms"></a>Platforms
</h3><p>
<a href="Platforms_HLOS.html">HLOS</a>
</p><p>
<a href="Platforms_Simulator.html">Simulator</a>
</p><p>
<a href="Platforms_Target.html">Target</a>
</p><hr>
<h3>
<a name="Environments"></a>Environments
</h3><p>
<a href="Environments_Build%20System.html">Build System</a>
</p><p>
<a href="Environments_Build%20System%20Porting.html">Build System Porting</a>
</p><p>
<a href="Environments_Hexagon%20IDE.html">Hexagon IDE</a>
</p><hr>
<h3>
<a name="ArchitectureOverview"></a>ArchitectureOverview
</h3><p>
<a href="HVX/ArchitectureOverview.html">HVX</a>
</p><hr>
<h3>
<a name="Applications"></a>Applications
</h3><p>
<a href="Audio/Applications.html">Audio</a>
</p><p>
<a href="Camera%20streaming/Applications.html">Camera streaming</a>
</p><p>
<a href="Applications_Compute%20offload.html">Compute offload</a>
</p><p>
<a href="FastCV/Applications_Computer%20Vision.html">Computer Vision</a>
</p><p>
<a href="Neural%20Networks/Applications.html">Neural Networks</a>
</p><p>
<a href="Voice/Applications.html">Voice</a>
</p><hr>
<h3>
<a name="APIs"></a>APIs
</h3><p>
<a href="APIs_Async%20Message%20Queue.html">Async Message Queue</a>
</p><p>
<a href="APIs_DSP%20Clk%20&amp;%20Rsrc%20Mgmt.html">DSP Clk &amp; Rsrc Mgmt</a>
</p><p>
<a href="APIs_Dynamic%20Loading.html">Dynamic Loading</a>
</p><p>
<a href="APIs_FastRPC.html">FastRPC</a>
</p><hr>
<h3>
<a name="Examples"></a>Examples
</h3><p>
<a href="Audio/Examples.html">Audio</a>
</p><p>
<a href="Camera%20streaming/Examples.html">Camera streaming</a>
</p><p>
<a href="Examples_Common.html">Common</a>
</p><p>
<a href="Examples_ComputeHVX.html">ComputeHVX</a>
</p><p>
<a href="Examples_GeneralOverview.html">GeneralOverview</a>
</p><p>
<a href="Neural%20Networks/Examples.html">Neural Networks</a>
</p><hr>
<h3>
<a name="Testing"></a>Testing
</h3><p>
<a href="CAPIv2/Testing_CAPIv2%20Unit%20Tests.html">CAPIv2 Unit Tests</a>
</p><p>
<a href="Testing_Eclipse%20Unit%20Tests.html">Eclipse Unit Tests</a>
</p><hr>
<h3>
<a name="Debugging"></a>Debugging
</h3><p>
<a href="Debugging_Connect%20to%20Device.html">Connect to Device</a>
</p><p>
<a href="Debugging_Exceptions.html">Exceptions</a>
</p><p>
<a href="Debugging_Message%20Logging.html">Message Logging</a>
</p><p>
<a href="Debugging_Simulator.html">Simulator</a>
</p><p>
<a href="Debugging_Target.html">Target</a>
</p><hr>
<h3>
<a name="Tools"></a>Tools
</h3><p>
<a href="Tools_Hexagon%20Tools%208.3.html">Hexagon Tools 8.3</a>
</p><p>
<a href="Tools_IDL%20Compiler.html">IDL Compiler</a>
</p><p>
<a href="Tools_On%20Target%20Profiling.html">On Target Profiling</a>
</p><p>
<a href="Tools_Scripts.html">Scripts</a>
</p><p>
<a href="Tools_Signing.html">Signing</a>
</p><p>
<a href="Tools_UserGuides.html">UserGuides</a>
</p><p>
<a href="Tools_Utilities.html">Utilities</a>
</p><hr>
<h3>
<a name="FAQ"></a>FAQ
</h3><p>
<a href="FAQ_Common.html">Common</a>
</p><p>
<a href="FAQ_Dynamic%20Loading.html">Dynamic Loading</a>
</p><p>
<a href="FAQ_FastRPC.html">FastRPC</a>
</p><p>
<a href="FAQ_Hexagon%20IDE.html">Hexagon IDE</a>
</p><hr>
<h3>
<a name="Dependencies"></a>Dependencies
</h3><p>
<a href="Dependencies_Common.html">Common</a>
</p><hr>
<h3>
<a name="Release%20Notes"></a>Release Notes
</h3><p>
<a href="Release%20Notes_Common.html">Common</a>
</p><hr>
<h3>
<a name="Support"></a>Support
</h3><p>
<a href="Support_Contact.html">Contact</a>
</p><center><img src="images/sidebar_bot.jpg"></center></div><div id="content"><a name="_top_" style="display:block;"></a><h1>
<a name="Signing"></a>Signing
</h1><div class="toc"><div class="tocLevel"><a href="#Introduction">Introduction</a></div><div class="tocLevel"><a href="#Unsigned%20PD">Unsigned PD</a><div class="tocLevel"><a href="#Unsigned%20PD%20available%20services">Unsigned PD available services</a></div><div class="tocLevel"><a href="#Unsigned%20PD%20limitations">Unsigned PD limitations</a></div><div class="tocLevel"><a href="#Request%20signature-free%20offload">Request signature-free offload</a></div></div><div class="tocLevel"><a href="#TestSigs">TestSigs</a></div><div class="tocLevel"><a href="#Using%20elfsigner">Using elfsigner</a><div class="tocLevel"><a href="#_Dependencies">Dependencies</a></div><div class="tocLevel"><a href="#Command-line%20usage">Command-line usage</a><div class="tocLevel"><a href="#Options">Options</a></div></div><div class="tocLevel"><a href="#Usage%20Examples">Usage Examples</a></div></div><div class="tocLevel"><a href="#Obtaining%20Device%20Serial%20Number">Obtaining Device Serial Number</a><div class="tocLevel"><a href="#Android">Android</a></div><div class="tocLevel"><a href="#Windows%20Phone">Windows Phone</a></div></div><div class="tocLevel"><a href="#Installing%20the%20TestSig%20on%20Device">Installing the TestSig on Device</a><div class="tocLevel"><a href="#Installation%20Example">Installation Example</a><div class="tocLevel"><a href="#_Android">Android</a></div><div class="tocLevel"><a href="#_Windows%20Phone">Windows Phone</a></div></div></div><div class="tocLevel"><a href="#Walk-through">Walk-through</a><div class="tocLevel"><a href="#On%20Android">On Android</a></div><div class="tocLevel"><a href="#On%20Windows%20Phone">On Windows Phone</a></div></div><div class="tocLevel"><a href="#Production-Signing">Production-Signing</a></div></div><h2>
<a name="Introduction"></a>Introduction
</h2><p>
Starting in the SM8150 family, <b>signature-free dynamic module offload</b> is enabled on cDSP. This allows signature-free dynamic shared objects to be offloaded to cDSP in a low-rights process (Unsigned PD). Please see <a href="#Unsigned%20PD">Unsigned PD</a> for further details. For use cases that require resources or privileges unavailable in the Unsigned PD, or for compatibility with legacy targets, please see the information on the code-signing utilities and processes below.
</p><p>
Signing is a mechanism of adding cryptographic signature into aDSP <a href="APIs_Dynamic%20Loading.html">dynamic modules</a> that can later be verified by the loader. Dynamic modules can be signed for debug devices using <a href="#TestSigs">TestSigs</a> or for production devices using <a href="#Production-Signing">Production Sigs</a>.
</p><p>
<b>elfsigner</b> is command-line utility used to generate digital signatures for aDSP dynamic shared objects and to generate test signatures (TestSigs) for facilitating development. Dynamic shared objects are required to be digitally signed and then authenticated at runtime before they are allowed to be loaded and executed.
</p><p>
<b>elfsigner</b> comes configured with a test private key and root certificate, which provides for generating signatures for dynamic modules that will be run on a device configured with the same test root certificate. For devices that are not configured as test devices, like commercial production devices, follow the instructions in <a href="#Production-Signing">Production-Signing</a>.
</p><h2>
<a name="Unsigned%20PD"></a>Unsigned PD
</h2><p>
Starting in the SM8150 family, clients can request to offload signature-free dynamic shared objects to cDSP. The signature-free dynamic shared object will be able to run inside the Unsigned PD on the cDSP.
</p><p>
Unsigned PD is a sandboxed low-rights process that allows the signature-free modules to run on the cDSP. In the event of a compromise, access to full system functionality and data is prevented by the sandbox. Unsigned PDs are designed to support general compute applications and have limited access to underlying drivers. Please see the services available in the Unsigned PD and the limitations below. The available / unavailable services in the Unsigned PD may change in the future based on continuing security reviews.
</p><h3>
<a name="Unsigned%20PD%20available%20services"></a>Unsigned PD available services
</h3><ul type="circle">
<li>
<p>
Thread creation and thread services
</p>
</li><li>
<p>
Timer creation and timer services
</p>
</li><li>
<p>
HVX contexts
</p>
</li><li>
<p>
Clock frequency controls
</p>
</li><li>
<p>
VTCM
</p>
</li><li>
<p>
Cache operations
</p>
</li><li>
<p>
Map HLOS memory allocated by corresponding HLOS application
</p>
</li>
</ul><h3>
<a name="Unsigned%20PD%20limitations"></a>Unsigned PD limitations
</h3><ul type="circle">
<li>
<p>
Access to limited drivers i.e. UBWC/DMA and Camera Streamer are not available to Unsigned PDs
</p>
</li><li>
<p>
Thread priorities limited to pre-defined range
</p>
</li>
</ul><h3>
<a name="Request%20signature-free%20offload"></a>Request signature-free offload
</h3><ul type="circle">
<li>
<p>
To request signature-free dynamic module offload, clients will have to make the request as follows
</p><div class="indent"><pre style="font-size: 81%">#pragma weak remote_session_control  
if (remote_session_control)
{
    struct remote_rpc_control_unsigned_module data;
    data.enable = 1;
    data.domain = CDSP_DOMAIN_ID;
    remote_session_control(DSPRPC_CONTROL_UNSIGNED_MODULE, (void*)&amp;data, sizeof(data));
}
</pre></div>
</li><li>
<p>
This request should be made before calling any other FastRPC function.
</p>
</li><li>
<p>
A success from the remote_session_control function allows the clients to offload the dynamic shared object to cDSP without signing.
</p>
</li>
</ul><h2>
<a name="TestSigs"></a>TestSigs
</h2><p>
A TestSig is a special type of dynamic shared object that when properly installed on a device, enables that device for development use by overriding the authentication requirement of other dynamic shared objects. This eliminates the need for signing individual shared objects allowing for faster development cycles.
</p><p>
The TestSig is a shared object named <code>testsig-XXXXXXXX.so</code> which contains a serial number corresponding to the specific device which it will be installed on. It must be signed by <b>elfsigner</b> with a command-line option that passes the device serial number to the TestSig.
</p><p>
Installing a TestSig is easier using the script <a href="Tools_Scripts.html">testsig.py</a> provided with the SDK. Also note that this installation needs to be done only once on the device.
</p><h2>
<a name="Using%20elfsigner"></a>Using elfsigner
</h2><h3>
<a name="_Dependencies"></a>Dependencies
</h3><p>
The elfsigner utility is implemented as a set of Python scripts, and as such requires that Python version 2.7 or above is installed on the host computer. Additional dependencies include:
</p><ul type="circle">
<li>
<p>
Windows 7 (32-bit or 64-bit) or higher (For Windows Users)
</p>
</li><li>
<p>
OpenSSL 1.0.1g for Linux (or later version) (For Linux Users)
</p>
</li><li>
<p>
The tool uses the system temporary folder as scratch space to create intermediate
</p>
</li>
</ul><p>
output. Make sure that the tool has permission to write to the location %temp% (This is an environment variable) in windows and to <code>/tmp</code> location in Linux.
</p><p>
Before calling ELFSigner ensure the SDK's dependencies are properly setup. The installer should have done this for you. If you encounter issues please see <a href="Dependencies_Common.html">Dependencies</a>.
</p><p>
Calling ELFSigner requires that the local environment be setup. To do this, first <a href="readme.html">setup</a> the sdk environment.
</p><h3>
<a name="Command-line%20usage"></a>Command-line usage
</h3><p>
ELFSigner is located at:
</p><pre>/tools/elfsigner/elfsigner.py
</pre><p>
There are two basic command-line forms for invoking <b>elfsigner</b>:
</p><pre>python elfsigner.py -t SERIALNUM -o [OUTPUTDIR]

   SERIALNUM is a 32-bit device serial number in hex form: 0xabcd0123
</pre><p>
In this form, a TestSig is generated and written to the OUTPUTDIR directory. No files are specified on the command line. The output filename is generated by concatenating 'testsig-' with the serial number value in hexadecimal, followed by the extension '.so'. For example: using <code>-t 0xaf0123</code> will create a file named: <code>testsig-0xaf0123.so.</code>
</p><pre>python elfsigner.py -i INFILE -o [OUTDIR]

   INFILE is the pathname of an ELF format shared object file to be signed.
   OUTDIR specifies the output folder's pathname of the signed output file.
</pre><p>
In this form, <b>elfsigner</b> produces a signed ELF file from an unsigned input file. A single file may be signed at each invocation. In its simplest form, OUTFILE may be omitted, in which case the signed output file is written to the current directory using the same name as the input file. If there is a naming conflict where the input file would be overwritten by the output file then the output file will be named <i>{input_filename_base}</i>_signed.so.
</p><h4>
<a name="Options"></a>Options
</h4><p>
For help with elfsigner options and usage, please type . python elfsigner.py -h
</p><p>
Commonly used options are:
</p><ul>
<li>
<p>
<b><code>--testsig=SERIALNUM, or -t SERIALNUM</code></b>
</p><p>
Generate a test signature tied to a device with the specified serial number. The serial number is a 32-bit number expressed in hexadecimal: such as <code>0x10203040</code>
</p><p>
The device serial number can be obtained by running the tool <b>getserial</b> from an adb shell. See section <a href="#Obtaining%20Device%20Serial%20Number">Obtaining Device Serial Number</a> below.
</p>
</li><li>
<p>
<b><code>--version</code></b>
</p><p>
Display the version number and exit.
</p>
</li><li>
<p>
<b><code>--help or -h</code></b>
</p><p>
Display a help message and exit.
</p>
</li>
</ul><h3>
<a name="Usage%20Examples"></a>Usage Examples
</h3><pre>python elfsigner.py --help
</pre><p>
Displays a help screen and exits
</p><pre>python elfsigner.py --version
</pre><p>
Displays the version number and exits.
</p><pre>python elfsigner.py --testsig=0xabcdef01
</pre><p>
Creates a TestSig in the current directory with the name: <code>testsig-0xabcdef01.so</code>, containing a serial number of 0xabcdef01.
</p><pre>python elfsigner.py -i dynmod.so -o signed/
</pre><p>
Signs the input file <code>dynmod.so</code> writes the signed output file to <code>./signed/dynmod.so</code>
</p><pre>python elfsigner.py -i input/dynmod.so -o signed/
</pre><p>
This command signs the input file <code>./input/dynmod.so</code> and writes the signed output file to <code>./signed/dynmod.so</code>
</p><h2>
<a name="Obtaining%20Device%20Serial%20Number"></a>Obtaining Device Serial Number
</h2><h3>
<a name="Android"></a>Android
</h3><p>
Use the command line Android application <b>getserial</b> to discover the serial number of your device. This utility is located in the <i>elfsigner</i> folder of the Hexagon&#8482; SDK. To obtain the serial number from commad line, the device needs to be connected to the host PC to run adb commands. Please refer the documentation <a href="Debugging_Connect%20to%20Device.html">connect to device</a> for details.
</p><p>
Usage of getserial is shown below.
</p><p>
Flash the <b>getserial</b> application to the device (via <b>adb</b>)
</p><pre>adb push &lt;local_path&gt;/getserial /data/getserial
</pre><p>
Set the execute bit on the application
</p><pre>adb shell chmod 755 /data/getserial
</pre><p>
Execute the application to retrieve the serial number
</p><pre>adb shell /data/getserial
</pre><p>
The above command returns the serial number of the attached device:
</p><pre>####################Serial number (see below)###########################

Serial Num : 0x13eb80

####################Serial number (see above)###########################
</pre><p>
Alternatively <b>GetSerial</b>, a GUI based android application, can also be used to retrieve the device's serial number. This application is also located in the <i>elfsigner</i> folder. Connect the device to your host PC and run the following command
</p><pre>
&lt;Hexagon SDK Dir&gt;\tools\elfsigner&gt;adb install getserial.apk
1631 KB/s (2464266 bytes in 1.475s)
      pkg: /data/local/tmp/getserial.apk
Success
</pre><p>
<b>GetSerial</b> can be directly run from your device's GUI. The connection to the host PC is not required while running the GUI based application.
</p><h3>
<a name="Windows%20Phone"></a>Windows Phone
</h3><p>
Use the Windows application <b>getserial.exe</b> to discover the serial number of your device. This utility is located in the <i>elfsigner</i> folder of the Hexagon&#8482; SDK. This has been validated for SM8180 device. Find below the steps to run getserial.
</p><p>
Find <b>MAC Address</b> of device and connect to the device. Open the&#160;Tshell window in admin command prompt.
</p><pre>(Get-CimInstance Win32_PnPEntity | where caption -match 'USB-EEM').pnpDeviceID
</pre><p>
The above command will produce an output like&#160;<code>USB\VID_045E&amp;PID_064D\00117F04BD6F</code>. The mac address of the device is <code>00117F04BD6F</code>.
</p><p>
Connect to the device using the above mac address. Enter the command <code>open-device &lt;mac address&gt;</code>.&#160;
</p><pre>open-device&#160;00117F04BD6F
</pre><p>
Push <i>getserial.exe</i> application to the device (via TShell). Create a new directory or use an existing temporary directory to push getserial onto the device. We are creating a new directory to push the file.
</p><pre style="font-size: 80%">mkdird getserial 
cdd getserial
putd &lt;HEXAGON_SDK_ROOT&gt;\tools\elfsigner\getserial\WinARM_Release_aarch64\getserial.exe .
</pre><p>
Push <b>libcdsprpc.dll</b> into the device. Go to the directory <code>C:\windows\system32\driverstore\filerepository\</code> on the device and search for <code>adsprpc</code> directory having the name in the format <code>qcadsprpc&lt;target&gt;.inf_arm64_&lt;identifier&gt;</code>.
</p><pre>eg. qcadsprpc&lt;target&gt;.inf_arm64_2c86f0ffd7cac0ee
</pre><p>
Once you reach the adsprpc directory, push the dll into the same location where you pushed <code>getserial.exe</code>.
</p><pre style="font-size: 60%">copyd windows\system32\driverstore\filerepository\qcadsprpc&lt;target&gt;.inf_arm64_&lt;identifier&gt;\libcdsprpc.dll C:\getserial
</pre><p>
Execute the application to retrieve the serial number:
</p><pre>cmdd getserial
</pre><p>
The above command returns the serial number of the attached device:
</p><pre>
####################Serial number (see below)###########################

Serial Num : 0x77b6ae61

####################Serial number (see above)###########################
</pre><h2>
<a name="Installing%20the%20TestSig%20on%20Device"></a>Installing the TestSig on Device
</h2><p>
TestSigs, after being generated with the correct device serial number, should be loaded into the root of the remote file system or other location as specified by the environment variable ADSP_LIBRARY_PATH. (See the <a href="remote_file_system.html">Remote File System</a> section for more information).
</p><p>
The TestSig produced by <b>elfsigner</b> will be named <code>testsig-0xXXXXX</code>, where <code>XXXXX</code> is the serial number specified on the command line.
</p><p>
Signature test mode is latched. This means that after reboot, test signatures are validated only once on the first call to load a dynamic object. Therefore after you copy the test signature to the device its a good idea to reboot the device so it gets recognized.
</p><h3>
<a name="Installation%20Example"></a>Installation Example
</h3><p>
In this example the device serial number is 0x12345 and the previously generated TestSig is named <code>testsig-0x12345.so</code>. The environment variable ADSP_LIBRARY_PATH is set to: <code>ADSP_LIBRARY_PATH=/data/adsp</code>.
</p><h4>
<a name="_Android"></a>Android
</h4><p>
Use <b>adb</b> to push the TestSig onto the device:
</p><pre>adb push testsig-0x12345.so /data/adsp/testsig-0x12345.so
</pre><h4>
<a name="_Windows%20Phone"></a>Windows Phone
</h4><p>
Use <b>TShell</b> to push Testsig onto the device:
</p><pre>putd testsig-0x12345.so C:\Windows\system32\drivers\Driverdata\qualcomm\fastrpc
</pre><h2>
<a name="Walk-through"></a>Walk-through
</h2><h3>
<a name="On%20Android"></a>On Android
</h3><ul type="circle">
<li>
<p>
First discover your device's serial number. The below steps will print out the device serial number. Example: 0x12345678
</p><pre style="font-size: 83%">adb push &lt;Hexagon SDK Dir&gt;\tools\elfsigner\getserial\android_Release\getserial /data/
adb shell chmod 777 /data/getserial
adb shell /data/getserial
</pre>
</li><li>
<p>
Next generate a test signature based on that serial number and push it to the device. The test signature is discovered on boot so a reboot is required.
</p><pre>cd &lt;Hexagon SDK Dir&gt;
setup SDK environment
python &lt;Hexagon SDK Dir&gt;\tools\elfsigner\elfsigner.py -t 0x&lt;serial number&gt;
adb push output/testsig-0x&lt;serial number&gt;.so /system/lib/rfsa/adsp/
adb reboot
adb wait-for-device
</pre>
</li><li>
<p>
The above steps are captured in the following script:
</p><pre>&lt;Hexagon SDK Dir&gt;\scripts\testsig.py
</pre>
</li>
</ul><h3>
<a name="On%20Windows%20Phone"></a>On Windows Phone
</h3><ul type="circle">
<li>
<p>
Use TShell to run the commands. First discover your device's serial number. The below steps will print out the device serial number. Example: 0x12345678
</p>
</li>
</ul><pre style="font-size: 60%">(Get-CimInstance Win32_PnPEntity | where caption -match 'USB-EEM').pnpDeviceID
open-device&#160;`MAC_Address`
mkdird getserial 
cdd getserial
putd &lt;HEXAGON_SDK_ROOT&gt;\tools\elfsigner\getserial\WinARM_Release_aarch64\getserial.exe .
copyd windows\system32\driverstore\filerepository\qcadsprpc&lt;target&gt;.inf_arm64_&lt;identifier&gt;\libcdsprpc.dll C:\getserial
cmdd getserial
</pre><ul type="circle">
<li>
<p>
Next generate a test signature based on that serial number and push it to the device.
</p>
</li>
</ul><pre style="font-size: 80%">cd &lt;Hexagon SDK Dir&gt;
setup SDK environment
python &lt;Hexagon SDK Dir&gt;\tools\elfsigner\elfsigner.py -t 0x&lt;serial number&gt;
putd testsig-0x&lt;serial number&gt;.so C:\Windows\system32\drivers\Driverdata\qualcomm\fastrpc
</pre><ul type="circle">
<li>
<p>
Reboot the phone. The test signature is discovered on boot so a reboot is required.
</p>
</li>
</ul><h2>
<a name="Production-Signing"></a>Production-Signing
</h2><p>
Signatures generated using the elfsigner from the SDK allow SDK users to prototype and test their software on debug devices such as DragonBoards. However these testsigs and signed .so files would not authenticate successfully on production devices such as OEM phones and tablets.
</p><p>
To enable a .so to be successfully deployed on production devices across a large number of OEM devices, the dynamic module needs to be production signed by the OEM. ISVs are encouraged to work with their OEM POCs to have the modules production signed for OEM devices.
</p><p align="center" style="display:block;padding-top: 50px;">
  Copyright &#169; 2018 Qualcomm Technologies Inc. All rights reserved.

</p><a style="display:block;padding-bottom: 700px;"></a></div></div>
</body>
</html>
